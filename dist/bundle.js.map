{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/bit_stream.js","src/bitmap.js","src/buffer_stream.js","src/resource.js","src/scumm/index.js","src/scumm/object.js","src/scumm/room.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","const Resource = require('./resource');\n\nconst Scumm = require('./scumm');\nconst Bitmap = require('./bitmap');\n\nconst INDEX_FILE = 'monkey2.000';\nconst BUNDLE_FILE = 'monkey2.001';\n\n// const INDEX_FILE = 'mi2demo.000';\n// const BUNDLE_FILE = 'mi2demo.001';\n\nclass App {\n  constructor() {\n    console.log('init');\n\n    this.files = [];\n\n    this.resource = new Resource();\n\n    this.offscreen = document.createElement('canvas');\n    this.offscreen.width = 320;\n    this.offscreen.height = 200;\n\n    window.addEventListener('DOMContentLoaded', () => {\n      this.createElements();\n      this.initEventListeners();\n    });\n  }\n\n  decode(buffer, enc=0) {\n    let temp = new Uint8Array(buffer);\n    for (var i = 0; i < temp.length; i++) {\n      temp[i] = temp[i] ^ enc;\n    }\n    return temp.buffer;\n  }\n\n  createPaletteElement() {\n    let palette = this.palette;\n\n    let paletteEl = this.paletteEl;\n    while(paletteEl.firstChild) paletteEl.removeChild(paletteEl.firstChild);\n\n    if (palette) {\n      for (var i = 0; i < 256; i++) {\n        let r = palette[i*3];\n        let g = palette[i*3 + 1];\n        let b = palette[i*3 + 2];\n        let swatch = document.createElement('div');\n        swatch.classList.add('palette-swatch');\n        swatch.style.backgroundColor = 'rgb('+r+','+g+','+b+')';\n        swatch.title = i + ':' + 'rgb('+r+','+g+','+b+')';\n        paletteEl.appendChild(swatch);\n      }\n    }\n  }\n\n  resizeOffscreenCanvas(width, height) {\n    this.offscreen.width = width;\n    this.offscreen.height = height;\n  }\n\n  createRoomImageElement() {\n    if (!this.room) return;\n    let room = this.room;\n\n    let width = room.width;\n    let height = room.height;\n\n    this.resizeOffscreenCanvas(width, height);\n\n    let ctx = this.offscreen.getContext('2d');\n    ctx.clearRect(0, 0, this.offscreen.width, this.offscreen.height);\n\n    if (room.bitmap) {\n      let imageData = ctx.getImageData(0, 0, width, height);\n\n      for (var i = 0; i < room.bitmap.length; i++) {\n        let index = room.bitmap[i];\n        imageData.data[i * 4 + 0] = this.palette[index * 3 + 0];\n        imageData.data[i * 4 + 1] = this.palette[index * 3 + 1];\n        imageData.data[i * 4 + 2] = this.palette[index * 3 + 2];\n        imageData.data[i * 4 + 3] = 255;\n      }\n\n      ctx.putImageData(imageData, 0, 0);\n    }\n\n    let canvas = this.canvas;\n    canvas.width = width;\n    canvas.height = height;\n\n    ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    // ctx.imageSmoothingEnabled = false;\n    ctx.drawImage(this.offscreen, 0, 0, this.offscreen.width, this.offscreen.height);\n    // this.canvasContainerEl.appendChild(canvas);\n  }\n\n  createRoomObjects() {\n\n  }\n\n  setRoom(num) {\n    let room = this.resource.getRoom(num);\n    if (room) {\n      this.room = room;\n      this.roomno = num;\n      this.palette = room.palette;\n\n      this.title.innerHTML = 'Room ' + room.id + ' ' + room.name + ' ' + room.width + 'x' + room.height;\n\n      this.createPaletteElement();\n      this.createRoomImageElement();\n      this.createRoomObjects();\n    }\n  }\n\n  parseFiles() {\n    if (this.files[INDEX_FILE]) {\n      // this.parseIndex();\n      this.resource.addIndex(this.files[INDEX_FILE]);\n    }\n    if (this.files[BUNDLE_FILE]) {\n      this.resource.addBundle(this.files[BUNDLE_FILE]);\n      this.setRoom(19);\n      // this.parseBundle();\n      // this.setRoom(4);\n    }\n  }\n\n  onFileLoaded(filename) {\n    console.log('Loaded', filename, this.files[filename].byteLength);\n\n    if (filename == INDEX_FILE || filename == BUNDLE_FILE) {\n      this.files[filename] = this.decode(this.files[filename], 0x69);\n    }\n\n    this.filesToLoad--;\n\n    if (this.filesToLoad == 0) {\n      console.log('done');\n      this.parseFiles();\n    }\n  }\n\n  loadFile(file) {\n    var reader = new FileReader();\n    var filename = file.name.toLowerCase();\n\t\treader.onload = (event) => {\n      this.files[filename] = event.target.result;\n      this.onFileLoaded(filename);\n\t\t};\n\t  reader.readAsArrayBuffer(file);\n  }\n\n  onDrop(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    var files = event.dataTransfer.files;\n    if (files.length) {\n      this.filesToLoad = files.length;\n      for (var i = 0; i < files.length; i++) {\n        this.loadFile(files[i]);\n      }\n    }\n  }\n\n  onDragEnter(event) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  onDragOver(event) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  onKeyDown(event) {\n    if (event.key == 'ArrowRight' && !event.repeat) {\n      this.setRoom(this.roomno + 1);\n    }\n    else if (event.key == 'ArrowLeft' && !event.repeat) {\n      this.setRoom(this.roomno - 1);\n    }\n  }\n\n  handleEvent(event) {\n    if (event.type == 'drop') {\n      this.onDrop(event);\n    }\n    else if (event.type == 'dragover') {\n      this.onDragOver(event);\n    }\n    else if (event.type == 'dragenter') {\n      this.onDragEnter(event);\n    }\n    else if (event.type == 'keydown') {\n      this.onKeyDown(event);\n    }\n  }\n\n  createElements() {\n    let el = document.createElement('div');\n    el.classList.add('container');\n    el.classList.add('room-container');\n\n    this.title = document.createElement('div');\n    this.title.classList.add('title');\n    this.title.innerHTML = 'title';\n    el.appendChild(this.title);\n\n    this.canvasContainerEl = document.createElement('div');\n    this.canvasContainerEl.classList.add('room-image');\n    this.canvas = document.createElement('canvas');\n    this.canvasContainerEl.appendChild(this.canvas);\n\n    el.appendChild(this.canvasContainerEl);\n\n    document.body.appendChild(el);\n\n    let containerEl = document.createElement('div');\n    containerEl.classList.add('container');\n    containerEl.classList.add('palette-container');\n\n    this.paletteEl = document.createElement('div');\n    this.paletteEl.classList.add('palette-swatches');\n    containerEl.appendChild(this.paletteEl);\n\n    document.body.appendChild(containerEl);\n  }\n\n  initEventListeners() {\n    window.addEventListener('drop', this, false);\n    window.addEventListener('dragenter', this, false);\n    window.addEventListener('dragover', this, false);\n\n    window.addEventListener('keydown', this, false);\n    window.addEventListener('keyup', this, false);\n  }\n}\n\nmodule.exports = App;\nglobal.App = App;\n","\nclass BitStream {\n  constructor(stream) {\n    this.stream = stream;\n    this.offset = 0;\n    this.cl = 0;\n  }\n\n  next() {\n    this.byte = this.stream.getUint8();\n    this.bit = this.byte & 1;\n    this.cl = 8;\n  }\n\n  shift() {\n    if (this.cl > 1) {\n      this.byte >>= 1;\n      this.bit = this.byte & 1;\n      this.cl--;\n    } else {\n      this.next();\n    }\n  }\n\n  read(length) {\n    if (this.cl == 0) {\n      this.next();\n    }\n\n    if (length) {\n      let value = 0;\n      for (var i = 0; i < length; i++) {\n        value |= (this.bit << i);\n        this.shift();\n      }\n      return value;\n    } else {\n      let value = this.bit ? 1 : 0;\n      this.shift();\n      return value;\n    }\n  }\n}\n\nmodule.exports = BitStream;\n","\nclass Bitmap {\n  constructor(params) {\n    this.width = params.width;\n    this.height = params.height;\n    this.pixels = params.pixels;\n  }\n}\n\nmodule.exports = Bitmap;\n","\nclass BufferStream {\n  constructor(buffer) {\n    this.buffer = buffer;\n    this.view = new DataView(this.buffer);\n    this.offset = 0;\n  }\n\n  get length() {\n    return this.buffer.byteLength;\n  }\n\n  seek(offset=0) {\n    this.offset = offset;\n  }\n\n  advance(count=1) {\n    this.offset += count;\n    if (this.offset > this.buffer.byteLength-1) this.offset = this.buffer.byteLength-1;\n  }\n\n  backup(count=1) {\n    this.offset -= count;\n    if (this.offset < 0) this.offset = 0;\n  }\n\n  getUint8(offset) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset++;\n    }\n    return this.view.getUint8(offset);\n  }\n\n  getUint16(offset, littleEndian=false) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += 2;\n    }\n    return this.view.getUint16(offset, littleEndian);\n  }\n\n  getUint32(offset, littleEndian=false) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += 4;\n    }\n    return this.view.getUint32(offset, littleEndian);\n  }\n\n  getUint16LE(offset) {\n    return this.getUint16(offset, true);\n  }\n\n  getUint32LE(offset) {\n    return this.getUint32(offset, true);\n  }\n\n  getBytes(length=1, offset) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += length;\n    }\n    let bytes = new Uint8Array(length);\n    for (var i = 0; i < length; i++) {\n      bytes[i] = this.view.getUint8(offset + i); //this.getUint8(offset + i);\n    }\n    return bytes;\n  }\n}\n\nmodule.exports = BufferStream;\n","const BufferStream = require('./buffer_stream');\nconst BitStream = require('./bit_stream');\nconst Scumm = require('./scumm');\n\nclass Resource {\n  constructor() {\n    this.rooms = [];\n    this.roomNames = [];\n  }\n\n  addIndex(buffer) {\n    this.parseIndex(buffer);\n  }\n\n  addBundle(buffer) {\n    this.parseBundle(buffer);\n  }\n\n  getRoom(num) {\n    return this.parseRoom(num);\n  }\n\n  getBlockTypeName(uint32) {\n    return String.fromCharCode(\n      (uint32 & 0xff),\n      ((uint32 >> 8) & 0xff),\n      ((uint32 >> 16) & 0xff),\n      ((uint32 >> 24) & 0xff)\n    );\n  }\n\n  parseBlockName(stream) {\n    let type = stream.getUint32LE();\n    return this.getBlockTypeName(type);\n  }\n\n  parseBlockHeader(stream) {\n    let type = stream.getUint32LE();\n    let size = stream.getUint32();\n    let name = this.getBlockTypeName(type);\n    return { type: type, size: size, name: name };\n  }\n\n  parseIndex(buffer) {\n    // if (!this.index) return;\n    console.log('parseIndex');\n    let stream = new BufferStream(buffer);\n\n    while (stream.offset < stream.length) {\n      let name = this.parseBlockName(stream);\n      let size = stream.getUint32();\n\n      if (name == 'RNAM') { // Room names table\n        while (1) {\n          let roomno = stream.getUint8();\n          if (roomno == 0) break;\n          let bytes = stream.getBytes(9);\n          // console.log(bytes);\n          this.roomNames[roomno] = bytes.reduce((accumulator, currentValue) => {\n            return accumulator + (currentValue != 0xff ? String.fromCharCode(currentValue ^ 0xff) : '');\n          }, '');\n          // console.log(this.roomNames[roomno]);\n        }\n        // console.log(this.roomNames);\n      // }\n      // else if (name == 'DROO') {\n      //   let numitems = stream.getUint16LE();\n      //   let roomNos = stream.getBytes(, numitems);\n      //\n      //   let roomOffsets = [];\n      //   for (var i = 0; i < numitems; i++) {\n      //     let offs = stream.getUint32LE();\n      //     roomOffsets[i] = offs;\n      //   }\n      } else {\n        stream.getBytes(size - 8);\n      }\n    }\n  }\n\n  // getBundleStream() {\n  //   let filename = BUNDLE_FILE;\n  //   if (!this.files[filename]) return;\n  //   let stream = new BufferStream(this.files[filename]);\n  //   return stream;\n  // }\n\n  decompress1(bits, shift, width, height) {\n    let pixels = new Uint8Array(width * height);\n    let offset = 0;\n\n    // let color = bits.read(shift);\n    let color = bits.read(8);\n\n    let inc = -1;\n\n    while (offset < width * height) {\n      pixels[offset++] = color;\n      if (bits.read()) {\n        if (!bits.read()) {\n          color = bits.read(shift);\n          inc = -1;\n          // color = bits.read(shift);\n          // inc = -1;\n        } else {\n          if (!bits.read()) {\n            color += inc;\n          } else {\n            inc = -inc;\n            color += inc;\n          }\n          // if (bits.read()) inc = -inc;\n          // color += inc;\n        }\n      }\n    }\n\n    return pixels;\n  }\n\n  decompress2(bits, shift, width, height) {\n    let pixels = new Uint8Array(width * height);\n    let offset = 0;\n\n    // let color = bits.read(shift);\n    let color = bits.read(8);\n    let skip = false;\n\n    while (offset < width * height) {\n      if (!skip) {\n        pixels[offset++] = color;\n        skip = false;\n      }\n\n      if (bits.read()) {\n        if (bits.read()) {\n          // adjust current palette index\n          let c = bits.read(3);\n          let incm = c - 4;\n          if (incm) {\n            color += incm;\n          } else {\n            // console.log('run');\n            let run = bits.read(8);\n            for (var i = 0; i < run; i++) {\n              pixels[offset++] = color;\n            }\n            skip = true;\n          }\n        } else {\n          // read a new palette index\n          color = bits.read(shift);\n        }\n      }\n    }\n    return pixels;\n  }\n\n  //scab-isl 01010100.01101110.11011010.00110100.01001101\n\n  decompressStrip(stream, width, height) {\n    let code = stream.getUint8();\n    let shift = code % 10;\n\n    let bits = new BitStream(stream);\n    let pixels;\n    let orientation = 0;\n\n    if (code == 0x01) { // raw horizontal\n      pixels = new Uint8Array(width * height);\n      for (var i = 0; i < pixels.length; i++) {\n        pixels[i] = stream.getUint8();\n      }\n    }\n    else if (code >= 0x0e && code <= 0x12) { // method 1 vertical\n      orientation = 1;\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x18 && code <= 0x1c) { // method 1 horizontal\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x22 && code <= 0x26) { // method 1 vertical transp\n      orientation = 1;\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x2c && code <= 0x30) { // method 1 horizontal transp\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x40 && code <= 0x44) { // method 2 horizontal\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x54 && code <= 0x58) { // method 2 horizontal transp\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x68 && code <= 0x6c) { // method 2 horizontal transp\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x7c && code <= 0x80) { // method 2 horizontal\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else {\n      console.log('unknown', code);\n    }\n\n    if (orientation) { // vertical\n      let temp = new Uint8Array(pixels.length);\n      for (var i = 0, index = 0; i < pixels.length; i++) {\n        temp[index] = pixels[i];\n        index += 8;\n        if (index >= height * 8) index = ((i / height) >> 0) + 1;\n      }\n      pixels = temp;\n    }\n\n    return pixels;\n  }\n\n  parseSmap(stream, width, height) {\n    let base = stream.offset;\n\n    let name = this.parseBlockName(stream);\n    let size = stream.getUint32();\n\n    if (name !== 'SMAP') return;\n\n    // console.log('smap', width, height);\n\n    let offsets = [];\n\n    for (var i = 0; i < width / 8; i++)\n      offsets.push(stream.getUint32LE());\n\n    let bitmap = new Uint8Array(width * height);\n\n    for (var i = 0; i < offsets.length; i++) {\n      stream.seek(base + offsets[i]);\n      let pixels = this.decompressStrip(stream, 8, height);\n      if (pixels) {\n        for (var j = 0, x = 0, y = 0; j < pixels.length; j++) {\n          bitmap[x + i * 8 + y * width] = pixels[j];\n          y = (x == 7 ? y + 1 : y);\n          x = (x == 7 ? 0 : x + 1);\n        }\n      } else {\n        console.log(i, offsets.length);\n      }\n\n    }\n\n    return bitmap;\n  }\n\n  parseOBIM(stream) {\n    let name = this.parseBlockName(stream);\n    if (name !== 'IMHD') return;\n    let size = stream.getUint32();\n\n    let id = stream.getUint16LE();\n    let imnn = stream.getUint16LE();\n    let zpnn = stream.getUint16LE();\n    let flags = stream.getUint8();\n    stream.advance();\n    let x = stream.getUint16LE();\n    let y = stream.getUint16LE();\n    let width = stream.getUint16LE();\n    let height = stream.getUint16LE();\n\n    let ob = {\n      id: id,\n      imnn: imnn,\n      zpnn: zpnn,\n      flags: flags,\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n\n    if (imnn) {\n      let name = this.parseBlockName(stream);\n      if (name.substring(0, 2) == 'IM') {\n        stream.advance(4);\n        ob.bitmap = this.parseSmap(stream, width, height);\n      }\n    }\n\n    return ob;\n  }\n\n  parseOBCD(stream) {\n    let name = this.parseBlockName(stream);\n    let size = stream.getUint32();\n    // console.log(name);\n\n    let id = stream.getUint16LE();\n    let x = stream.getUint8();\n    let y = stream.getUint8();\n    let width = stream.getUint8();\n    let height = stream.getUint8();\n    let flags = stream.getUint8();\n    let parent = stream.getUint8();\n    let walk_x = stream.getUint16LE();\n    let walk_y = stream.getUint16LE();\n    let actor_dir = stream.getUint8();\n\n    let ob = {\n      id: id,\n      flags: flags,\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n    stream.advance(size - 8);\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n\n    ob.name = '';\n    for (let b = stream.getUint8(); b !== 0; b = stream.getUint8()) {\n      ob.name += String.fromCharCode(b);\n    }\n\n    return ob;\n  }\n\n  parseRoom(num) {\n    let block = this.rooms[num];\n    if (!block) return;\n\n    let stream = new BufferStream(block.buffer);\n\n    let end = block.length;\n\n    let width;\n    let height;\n    let numObjects;\n    let palette;\n    let bitmap;\n    let obIMs = [];\n    let obCDs = [];\n\n    while (stream.offset < end) {\n      let name = this.parseBlockName(stream);\n      let size = stream.getUint32();\n      let jump = stream.offset + size - 8;\n\n      if (name == 'RMHD') {\n        width = stream.getUint16LE();\n        height = stream.getUint16LE();\n        numObjects = stream.getUint16LE();\n      }\n      else if (name == 'RMIM') {\n        stream.advance(18);\n        bitmap = this.parseSmap(stream, width, height);\n      }\n      else if (name == 'CLUT') {\n        palette = [];\n        for (var i = 0; i < 256; i++) {\n          let r = stream.getUint8();\n          let g = stream.getUint8();\n          let b = stream.getUint8();\n          palette.push(r, g, b);\n        }\n      }\n      else if (name == 'OBIM') {\n        let ob = this.parseOBIM(stream);\n        obIMs[ob.id] = ob;\n      }\n      else if (name == 'OBCD') {\n        let ob = this.parseOBCD(stream);\n        obCDs[ob.id] = ob;\n      }\n      else {\n        // stream.getBytes(size - 8);\n      }\n      stream.seek(jump);\n    }\n\n    let room = new Scumm.Room({\n      id: num,\n      name: this.roomNames[num],\n      width: width,\n      height: height,\n      numObjects: numObjects,\n      obIMs: obIMs,\n      obCDs: obCDs,\n      bitmap: bitmap,\n      palette: palette\n    });\n\n    return room;\n  }\n\n  parseBundle(buffer) {\n    console.log('parseBundle');\n\n    let stream = new BufferStream(buffer);\n\n    let name = this.parseBlockName(stream);\n    let size = stream.getUint32();\n\n    if (name != 'LECF') return;\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n\n    if (name == 'LOFF') {\n      this.numrooms = stream.getUint8();\n\n      let offsets = [];\n\n      for (var i = 0; i < this.numrooms; i++) {\n        let id = stream.getUint8();\n        let offs = stream.getUint32LE();\n        offsets[id] = offs;\n      }\n\n      for (var i = 0; i < offsets.length; i++) {\n        let offs = offsets[i];\n        if (offs != undefined) {\n          stream.seek(offs);\n          let name = this.parseBlockName(stream);\n          let size = stream.getUint32();\n          this.rooms[i] = stream.getBytes(size - 8);\n        }\n      }\n    }\n  }\n\n}\n\nmodule.exports = Resource;\n","\nvar Scumm = {\n  Object: require('./object'),\n  Room: require('./room')\n}\n\nmodule.exports = Scumm;\n","\nclass Object {\n  constructor(params) {\n    this.id = params.id;\n    this.imnn = params.imnn;\n    this.zpnn = params.zpnn;\n    this.flags = params.flags;\n    this.x = params.x;\n    this.y = params.y;\n    this.width = params.width;\n    this.height = params.height;\n  }\n}\n\nmodule.exports = Object;\n","\nclass Room {\n  constructor(params) {\n    this.id = params.id;\n    this.name = params.name;\n    this.width = params.width;\n    this.height = params.height;\n    this.numObjects = params.numObjects;\n    this.objects = params.objects;\n    this.palette = params.palette;\n    this.bitmap = params.bitmap;\n  }\n}\n\nmodule.exports = Room;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2JpdF9zdHJlYW0uanMiLCJzcmMvYml0bWFwLmpzIiwic3JjL2J1ZmZlcl9zdHJlYW0uanMiLCJzcmMvcmVzb3VyY2UuanMiLCJzcmMvc2N1bW0vaW5kZXguanMiLCJzcmMvc2N1bW0vb2JqZWN0LmpzIiwic3JjL3NjdW1tL3Jvb20uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUEsTUFBTSxXQUFXLFFBQVEsWUFBUixDQUFqQjs7QUFFQSxNQUFNLFFBQVEsUUFBUSxTQUFSLENBQWQ7QUFDQSxNQUFNLFNBQVMsUUFBUSxVQUFSLENBQWY7O0FBRUEsTUFBTSxhQUFhLGFBQW5CO0FBQ0EsTUFBTSxjQUFjLGFBQXBCOztBQUVBO0FBQ0E7O0FBRUEsTUFBTSxHQUFOLENBQVU7QUFDUixnQkFBYztBQUNaLFlBQVEsR0FBUixDQUFZLE1BQVo7O0FBRUEsU0FBSyxLQUFMLEdBQWEsRUFBYjs7QUFFQSxTQUFLLFFBQUwsR0FBZ0IsSUFBSSxRQUFKLEVBQWhCOztBQUVBLFNBQUssU0FBTCxHQUFpQixTQUFTLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBakI7QUFDQSxTQUFLLFNBQUwsQ0FBZSxLQUFmLEdBQXVCLEdBQXZCO0FBQ0EsU0FBSyxTQUFMLENBQWUsTUFBZixHQUF3QixHQUF4Qjs7QUFFQSxXQUFPLGdCQUFQLENBQXdCLGtCQUF4QixFQUE0QyxNQUFNO0FBQ2hELFdBQUssY0FBTDtBQUNBLFdBQUssa0JBQUw7QUFDRCxLQUhEO0FBSUQ7O0FBRUQsU0FBTyxNQUFQLEVBQWUsTUFBSSxDQUFuQixFQUFzQjtBQUNwQixRQUFJLE9BQU8sSUFBSSxVQUFKLENBQWUsTUFBZixDQUFYO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLEtBQUssTUFBekIsRUFBaUMsR0FBakMsRUFBc0M7QUFDcEMsV0FBSyxDQUFMLElBQVUsS0FBSyxDQUFM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QWMsT0FBTyxNQUFyQjtBQUNBLFNBQUssVUFBTCxHQUFrQixPQUFPLFVBQXpCO0FBQ0EsU0FBSyxPQUFMLEdBQWUsT0FBTyxPQUF0QjtBQUNBLFNBQUssT0FBTCxHQUFlLE9BQU8sT0FBdEI7QUFDQSxTQUFLLE1BQUwsR0FBYyxPQUFPLE1BQXJCO0FBQ0Q7QUFWUTs7QUFhWCxPQUFPLE9BQVAsR0FBaUIsSUFBakIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfXJldHVybiBlfSkoKSIsImNvbnN0IFJlc291cmNlID0gcmVxdWlyZSgnLi9yZXNvdXJjZScpO1xuXG5jb25zdCBTY3VtbSA9IHJlcXVpcmUoJy4vc2N1bW0nKTtcbmNvbnN0IEJpdG1hcCA9IHJlcXVpcmUoJy4vYml0bWFwJyk7XG5cbmNvbnN0IElOREVYX0ZJTEUgPSAnbW9ua2V5Mi4wMDAnO1xuY29uc3QgQlVORExFX0ZJTEUgPSAnbW9ua2V5Mi4wMDEnO1xuXG4vLyBjb25zdCBJTkRFWF9GSUxFID0gJ21pMmRlbW8uMDAwJztcbi8vIGNvbnN0IEJVTkRMRV9GSUxFID0gJ21pMmRlbW8uMDAxJztcblxuY2xhc3MgQXBwIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc29sZS5sb2coJ2luaXQnKTtcblxuICAgIHRoaXMuZmlsZXMgPSBbXTtcblxuICAgIHRoaXMucmVzb3VyY2UgPSBuZXcgUmVzb3VyY2UoKTtcblxuICAgIHRoaXMub2Zmc2NyZWVuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgdGhpcy5vZmZzY3JlZW4ud2lkdGggPSAzMjA7XG4gICAgdGhpcy5vZmZzY3JlZW4uaGVpZ2h0ID0gMjAwO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLmNyZWF0ZUVsZW1lbnRzKCk7XG4gICAgICB0aGlzLmluaXRFdmVudExpc3RlbmVycygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVjb2RlKGJ1ZmZlciwgZW5jPTApIHtcbiAgICBsZXQgdGVtcCA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZW1wLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0ZW1wW2ldID0gdGVtcFtpXSBeIGVuYztcbiAgICB9XG4gICAgcmV0dXJuIHRlbXAuYnVmZmVyO1xuICB9XG5cbiAgY3JlYXRlUGFsZXR0ZUVsZW1lbnQoKSB7XG4gICAgbGV0IHBhbGV0dGUgPSB0aGlzLnBhbGV0dGU7XG5cbiAgICBsZXQgcGFsZXR0ZUVsID0gdGhpcy5wYWxldHRlRWw7XG4gICAgd2hpbGUocGFsZXR0ZUVsLmZpcnN0Q2hpbGQpIHBhbGV0dGVFbC5yZW1vdmVDaGlsZChwYWxldHRlRWwuZmlyc3RDaGlsZCk7XG5cbiAgICBpZiAocGFsZXR0ZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7IGkrKykge1xuICAgICAgICBsZXQgciA9IHBhbGV0dGVbaSozXTtcbiAgICAgICAgbGV0IGcgPSBwYWxldHRlW2kqMyArIDFdO1xuICAgICAgICBsZXQgYiA9IHBhbGV0dGVbaSozICsgMl07XG4gICAgICAgIGxldCBzd2F0Y2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgc3dhdGNoLmNsYXNzTGlzdC5hZGQoJ3BhbGV0dGUtc3dhdGNoJyk7XG4gICAgICAgIHN3YXRjaC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKCcrcisnLCcrZysnLCcrYisnKSc7XG4gICAgICAgIHN3YXRjaC50aXRsZSA9IGkgKyAnOicgKyAncmdiKCcrcisnLCcrZysnLCcrYisnKSc7XG4gICAgICAgIHBhbGV0dGVFbC5hcHBlbmRDaGlsZChzd2F0Y2gpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlc2l6ZU9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgdGhpcy5vZmZzY3JlZW4ud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLm9mZnNjcmVlbi5oZWlnaHQgPSBoZWlnaHQ7XG4gIH1cblxuICBjcmVhdGVSb29tSW1hZ2VFbGVtZW50KCkge1xuICAgIGlmICghdGhpcy5yb29tKSByZXR1cm47XG4gICAgbGV0IHJvb20gPSB0aGlzLnJvb207XG5cbiAgICBsZXQgd2lkdGggPSByb29tLndpZHRoO1xuICAgIGxldCBoZWlnaHQgPSByb29tLmhlaWdodDtcblxuICAgIHRoaXMucmVzaXplT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgbGV0IGN0eCA9IHRoaXMub2Zmc2NyZWVuLmdldENvbnRleHQoJzJkJyk7XG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLm9mZnNjcmVlbi53aWR0aCwgdGhpcy5vZmZzY3JlZW4uaGVpZ2h0KTtcblxuICAgIGlmIChyb29tLmJpdG1hcCkge1xuICAgICAgbGV0IGltYWdlRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm9vbS5iaXRtYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGluZGV4ID0gcm9vbS5iaXRtYXBbaV07XG4gICAgICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgMF0gPSB0aGlzLnBhbGV0dGVbaW5kZXggKiAzICsgMF07XG4gICAgICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgMV0gPSB0aGlzLnBhbGV0dGVbaW5kZXggKiAzICsgMV07XG4gICAgICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgMl0gPSB0aGlzLnBhbGV0dGVbaW5kZXggKiAzICsgMl07XG4gICAgICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgM10gPSAyNTU7XG4gICAgICB9XG5cbiAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICB9XG5cbiAgICBsZXQgY2FudmFzID0gdGhpcy5jYW52YXM7XG4gICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcblxuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAvLyBjdHguaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgY3R4LmRyYXdJbWFnZSh0aGlzLm9mZnNjcmVlbiwgMCwgMCwgdGhpcy5vZmZzY3JlZW4ud2lkdGgsIHRoaXMub2Zmc2NyZWVuLmhlaWdodCk7XG4gICAgLy8gdGhpcy5jYW52YXNDb250YWluZXJFbC5hcHBlbmRDaGlsZChjYW52YXMpO1xuICB9XG5cbiAgY3JlYXRlUm9vbU9iamVjdHMoKSB7XG5cbiAgfVxuXG4gIHNldFJvb20obnVtKSB7XG4gICAgbGV0IHJvb20gPSB0aGlzLnJlc291cmNlLmdldFJvb20obnVtKTtcbiAgICBpZiAocm9vbSkge1xuICAgICAgdGhpcy5yb29tID0gcm9vbTtcbiAgICAgIHRoaXMucm9vbW5vID0gbnVtO1xuICAgICAgdGhpcy5wYWxldHRlID0gcm9vbS5wYWxldHRlO1xuXG4gICAgICB0aGlzLnRpdGxlLmlubmVySFRNTCA9ICdSb29tICcgKyByb29tLmlkICsgJyAnICsgcm9vbS5uYW1lICsgJyAnICsgcm9vbS53aWR0aCArICd4JyArIHJvb20uaGVpZ2h0O1xuXG4gICAgICB0aGlzLmNyZWF0ZVBhbGV0dGVFbGVtZW50KCk7XG4gICAgICB0aGlzLmNyZWF0ZVJvb21JbWFnZUVsZW1lbnQoKTtcbiAgICAgIHRoaXMuY3JlYXRlUm9vbU9iamVjdHMoKTtcbiAgICB9XG4gIH1cblxuICBwYXJzZUZpbGVzKCkge1xuICAgIGlmICh0aGlzLmZpbGVzW0lOREVYX0ZJTEVdKSB7XG4gICAgICAvLyB0aGlzLnBhcnNlSW5kZXgoKTtcbiAgICAgIHRoaXMucmVzb3VyY2UuYWRkSW5kZXgodGhpcy5maWxlc1tJTkRFWF9GSUxFXSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmZpbGVzW0JVTkRMRV9GSUxFXSkge1xuICAgICAgdGhpcy5yZXNvdXJjZS5hZGRCdW5kbGUodGhpcy5maWxlc1tCVU5ETEVfRklMRV0pO1xuICAgICAgdGhpcy5zZXRSb29tKDE5KTtcbiAgICAgIC8vIHRoaXMucGFyc2VCdW5kbGUoKTtcbiAgICAgIC8vIHRoaXMuc2V0Um9vbSg0KTtcbiAgICB9XG4gIH1cblxuICBvbkZpbGVMb2FkZWQoZmlsZW5hbWUpIHtcbiAgICBjb25zb2xlLmxvZygnTG9hZGVkJywgZmlsZW5hbWUsIHRoaXMuZmlsZXNbZmlsZW5hbWVdLmJ5dGVMZW5ndGgpO1xuXG4gICAgaWYgKGZpbGVuYW1lID09IElOREVYX0ZJTEUgfHwgZmlsZW5hbWUgPT0gQlVORExFX0ZJTEUpIHtcbiAgICAgIHRoaXMuZmlsZXNbZmlsZW5hbWVdID0gdGhpcy5kZWNvZGUodGhpcy5maWxlc1tmaWxlbmFtZV0sIDB4NjkpO1xuICAgIH1cblxuICAgIHRoaXMuZmlsZXNUb0xvYWQtLTtcblxuICAgIGlmICh0aGlzLmZpbGVzVG9Mb2FkID09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdkb25lJyk7XG4gICAgICB0aGlzLnBhcnNlRmlsZXMoKTtcbiAgICB9XG4gIH1cblxuICBsb2FkRmlsZShmaWxlKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgdmFyIGZpbGVuYW1lID0gZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0cmVhZGVyLm9ubG9hZCA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5maWxlc1tmaWxlbmFtZV0gPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgdGhpcy5vbkZpbGVMb2FkZWQoZmlsZW5hbWUpO1xuXHRcdH07XG5cdCAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpO1xuICB9XG5cbiAgb25Ecm9wKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIHZhciBmaWxlcyA9IGV2ZW50LmRhdGFUcmFuc2Zlci5maWxlcztcbiAgICBpZiAoZmlsZXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmZpbGVzVG9Mb2FkID0gZmlsZXMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmxvYWRGaWxlKGZpbGVzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbkRyYWdFbnRlcihldmVudCkge1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH1cblxuICBvbkRyYWdPdmVyKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfVxuXG4gIG9uS2V5RG93bihldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT0gJ0Fycm93UmlnaHQnICYmICFldmVudC5yZXBlYXQpIHtcbiAgICAgIHRoaXMuc2V0Um9vbSh0aGlzLnJvb21ubyArIDEpO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudC5rZXkgPT0gJ0Fycm93TGVmdCcgJiYgIWV2ZW50LnJlcGVhdCkge1xuICAgICAgdGhpcy5zZXRSb29tKHRoaXMucm9vbW5vIC0gMSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudHlwZSA9PSAnZHJvcCcpIHtcbiAgICAgIHRoaXMub25Ecm9wKGV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PSAnZHJhZ292ZXInKSB7XG4gICAgICB0aGlzLm9uRHJhZ092ZXIoZXZlbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudC50eXBlID09ICdkcmFnZW50ZXInKSB7XG4gICAgICB0aGlzLm9uRHJhZ0VudGVyKGV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PSAna2V5ZG93bicpIHtcbiAgICAgIHRoaXMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGVFbGVtZW50cygpIHtcbiAgICBsZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbC5jbGFzc0xpc3QuYWRkKCdjb250YWluZXInKTtcbiAgICBlbC5jbGFzc0xpc3QuYWRkKCdyb29tLWNvbnRhaW5lcicpO1xuXG4gICAgdGhpcy50aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMudGl0bGUuY2xhc3NMaXN0LmFkZCgndGl0bGUnKTtcbiAgICB0aGlzLnRpdGxlLmlubmVySFRNTCA9ICd0aXRsZSc7XG4gICAgZWwuYXBwZW5kQ2hpbGQodGhpcy50aXRsZSk7XG5cbiAgICB0aGlzLmNhbnZhc0NvbnRhaW5lckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5jYW52YXNDb250YWluZXJFbC5jbGFzc0xpc3QuYWRkKCdyb29tLWltYWdlJyk7XG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICB0aGlzLmNhbnZhc0NvbnRhaW5lckVsLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcblxuICAgIGVsLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzQ29udGFpbmVyRWwpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7XG5cbiAgICBsZXQgY29udGFpbmVyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXJFbC5jbGFzc0xpc3QuYWRkKCdjb250YWluZXInKTtcbiAgICBjb250YWluZXJFbC5jbGFzc0xpc3QuYWRkKCdwYWxldHRlLWNvbnRhaW5lcicpO1xuXG4gICAgdGhpcy5wYWxldHRlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLnBhbGV0dGVFbC5jbGFzc0xpc3QuYWRkKCdwYWxldHRlLXN3YXRjaGVzJyk7XG4gICAgY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQodGhpcy5wYWxldHRlRWwpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXJFbCk7XG4gIH1cblxuICBpbml0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIHRoaXMsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLCBmYWxzZSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLCBmYWxzZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBcHA7XG5nbG9iYWwuQXBwID0gQXBwO1xuIiwiXG5jbGFzcyBCaXRTdHJlYW0ge1xuICBjb25zdHJ1Y3RvcihzdHJlYW0pIHtcbiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTtcbiAgICB0aGlzLm9mZnNldCA9IDA7XG4gICAgdGhpcy5jbCA9IDA7XG4gIH1cblxuICBuZXh0KCkge1xuICAgIHRoaXMuYnl0ZSA9IHRoaXMuc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgdGhpcy5iaXQgPSB0aGlzLmJ5dGUgJiAxO1xuICAgIHRoaXMuY2wgPSA4O1xuICB9XG5cbiAgc2hpZnQoKSB7XG4gICAgaWYgKHRoaXMuY2wgPiAxKSB7XG4gICAgICB0aGlzLmJ5dGUgPj49IDE7XG4gICAgICB0aGlzLmJpdCA9IHRoaXMuYnl0ZSAmIDE7XG4gICAgICB0aGlzLmNsLS07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubmV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIHJlYWQobGVuZ3RoKSB7XG4gICAgaWYgKHRoaXMuY2wgPT0gMCkge1xuICAgICAgdGhpcy5uZXh0KCk7XG4gICAgfVxuXG4gICAgaWYgKGxlbmd0aCkge1xuICAgICAgbGV0IHZhbHVlID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFsdWUgfD0gKHRoaXMuYml0IDw8IGkpO1xuICAgICAgICB0aGlzLnNoaWZ0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCB2YWx1ZSA9IHRoaXMuYml0ID8gMSA6IDA7XG4gICAgICB0aGlzLnNoaWZ0KCk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQml0U3RyZWFtO1xuIiwiXG5jbGFzcyBCaXRtYXAge1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICB0aGlzLndpZHRoID0gcGFyYW1zLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgICB0aGlzLnBpeGVscyA9IHBhcmFtcy5waXhlbHM7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCaXRtYXA7XG4iLCJcbmNsYXNzIEJ1ZmZlclN0cmVhbSB7XG4gIGNvbnN0cnVjdG9yKGJ1ZmZlcikge1xuICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyO1xuICAgIHRoaXMudmlldyA9IG5ldyBEYXRhVmlldyh0aGlzLmJ1ZmZlcik7XG4gICAgdGhpcy5vZmZzZXQgPSAwO1xuICB9XG5cbiAgZ2V0IGxlbmd0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5idWZmZXIuYnl0ZUxlbmd0aDtcbiAgfVxuXG4gIHNlZWsob2Zmc2V0PTApIHtcbiAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcbiAgfVxuXG4gIGFkdmFuY2UoY291bnQ9MSkge1xuICAgIHRoaXMub2Zmc2V0ICs9IGNvdW50O1xuICAgIGlmICh0aGlzLm9mZnNldCA+IHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGgtMSkgdGhpcy5vZmZzZXQgPSB0aGlzLmJ1ZmZlci5ieXRlTGVuZ3RoLTE7XG4gIH1cblxuICBiYWNrdXAoY291bnQ9MSkge1xuICAgIHRoaXMub2Zmc2V0IC09IGNvdW50O1xuICAgIGlmICh0aGlzLm9mZnNldCA8IDApIHRoaXMub2Zmc2V0ID0gMDtcbiAgfVxuXG4gIGdldFVpbnQ4KG9mZnNldCkge1xuICAgIGlmIChvZmZzZXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldDtcbiAgICAgIHRoaXMub2Zmc2V0Kys7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnZpZXcuZ2V0VWludDgob2Zmc2V0KTtcbiAgfVxuXG4gIGdldFVpbnQxNihvZmZzZXQsIGxpdHRsZUVuZGlhbj1mYWxzZSkge1xuICAgIGlmIChvZmZzZXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldDtcbiAgICAgIHRoaXMub2Zmc2V0ICs9IDI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnZpZXcuZ2V0VWludDE2KG9mZnNldCwgbGl0dGxlRW5kaWFuKTtcbiAgfVxuXG4gIGdldFVpbnQzMihvZmZzZXQsIGxpdHRsZUVuZGlhbj1mYWxzZSkge1xuICAgIGlmIChvZmZzZXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldDtcbiAgICAgIHRoaXMub2Zmc2V0ICs9IDQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnZpZXcuZ2V0VWludDMyKG9mZnNldCwgbGl0dGxlRW5kaWFuKTtcbiAgfVxuXG4gIGdldFVpbnQxNkxFKG9mZnNldCkge1xuICAgIHJldHVybiB0aGlzLmdldFVpbnQxNihvZmZzZXQsIHRydWUpO1xuICB9XG5cbiAgZ2V0VWludDMyTEUob2Zmc2V0KSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7XG4gIH1cblxuICBnZXRCeXRlcyhsZW5ndGg9MSwgb2Zmc2V0KSB7XG4gICAgaWYgKG9mZnNldCA9PSB1bmRlZmluZWQpIHtcbiAgICAgIG9mZnNldCA9IHRoaXMub2Zmc2V0O1xuICAgICAgdGhpcy5vZmZzZXQgKz0gbGVuZ3RoO1xuICAgIH1cbiAgICBsZXQgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ5dGVzW2ldID0gdGhpcy52aWV3LmdldFVpbnQ4KG9mZnNldCArIGkpOyAvL3RoaXMuZ2V0VWludDgob2Zmc2V0ICsgaSk7XG4gICAgfVxuICAgIHJldHVybiBieXRlcztcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEJ1ZmZlclN0cmVhbTtcbiIsImNvbnN0IEJ1ZmZlclN0cmVhbSA9IHJlcXVpcmUoJy4vYnVmZmVyX3N0cmVhbScpO1xuY29uc3QgQml0U3RyZWFtID0gcmVxdWlyZSgnLi9iaXRfc3RyZWFtJyk7XG5jb25zdCBTY3VtbSA9IHJlcXVpcmUoJy4vc2N1bW0nKTtcblxuY2xhc3MgUmVzb3VyY2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJvb21zID0gW107XG4gICAgdGhpcy5yb29tTmFtZXMgPSBbXTtcbiAgfVxuXG4gIGFkZEluZGV4KGJ1ZmZlcikge1xuICAgIHRoaXMucGFyc2VJbmRleChidWZmZXIpO1xuICB9XG5cbiAgYWRkQnVuZGxlKGJ1ZmZlcikge1xuICAgIHRoaXMucGFyc2VCdW5kbGUoYnVmZmVyKTtcbiAgfVxuXG4gIGdldFJvb20obnVtKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyc2VSb29tKG51bSk7XG4gIH1cblxuICBnZXRCbG9ja1R5cGVOYW1lKHVpbnQzMikge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKFxuICAgICAgKHVpbnQzMiAmIDB4ZmYpLFxuICAgICAgKCh1aW50MzIgPj4gOCkgJiAweGZmKSxcbiAgICAgICgodWludDMyID4+IDE2KSAmIDB4ZmYpLFxuICAgICAgKCh1aW50MzIgPj4gMjQpICYgMHhmZilcbiAgICApO1xuICB9XG5cbiAgcGFyc2VCbG9ja05hbWUoc3RyZWFtKSB7XG4gICAgbGV0IHR5cGUgPSBzdHJlYW0uZ2V0VWludDMyTEUoKTtcbiAgICByZXR1cm4gdGhpcy5nZXRCbG9ja1R5cGVOYW1lKHR5cGUpO1xuICB9XG5cbiAgcGFyc2VCbG9ja0hlYWRlcihzdHJlYW0pIHtcbiAgICBsZXQgdHlwZSA9IHN0cmVhbS5nZXRVaW50MzJMRSgpO1xuICAgIGxldCBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuICAgIGxldCBuYW1lID0gdGhpcy5nZXRCbG9ja1R5cGVOYW1lKHR5cGUpO1xuICAgIHJldHVybiB7IHR5cGU6IHR5cGUsIHNpemU6IHNpemUsIG5hbWU6IG5hbWUgfTtcbiAgfVxuXG4gIHBhcnNlSW5kZXgoYnVmZmVyKSB7XG4gICAgLy8gaWYgKCF0aGlzLmluZGV4KSByZXR1cm47XG4gICAgY29uc29sZS5sb2coJ3BhcnNlSW5kZXgnKTtcbiAgICBsZXQgc3RyZWFtID0gbmV3IEJ1ZmZlclN0cmVhbShidWZmZXIpO1xuXG4gICAgd2hpbGUgKHN0cmVhbS5vZmZzZXQgPCBzdHJlYW0ubGVuZ3RoKSB7XG4gICAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAgIGxldCBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuXG4gICAgICBpZiAobmFtZSA9PSAnUk5BTScpIHsgLy8gUm9vbSBuYW1lcyB0YWJsZVxuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIGxldCByb29tbm8gPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgICAgICBpZiAocm9vbW5vID09IDApIGJyZWFrO1xuICAgICAgICAgIGxldCBieXRlcyA9IHN0cmVhbS5nZXRCeXRlcyg5KTtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhieXRlcyk7XG4gICAgICAgICAgdGhpcy5yb29tTmFtZXNbcm9vbW5vXSA9IGJ5dGVzLnJlZHVjZSgoYWNjdW11bGF0b3IsIGN1cnJlbnRWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yICsgKGN1cnJlbnRWYWx1ZSAhPSAweGZmID8gU3RyaW5nLmZyb21DaGFyQ29kZShjdXJyZW50VmFsdWUgXiAweGZmKSA6ICcnKTtcbiAgICAgICAgICB9LCAnJyk7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5yb29tTmFtZXNbcm9vbW5vXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5yb29tTmFtZXMpO1xuICAgICAgLy8gfVxuICAgICAgLy8gZWxzZSBpZiAobmFtZSA9PSAnRFJPTycpIHtcbiAgICAgIC8vICAgbGV0IG51bWl0ZW1zID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgICAvLyAgIGxldCByb29tTm9zID0gc3RyZWFtLmdldEJ5dGVzKCwgbnVtaXRlbXMpO1xuICAgICAgLy9cbiAgICAgIC8vICAgbGV0IHJvb21PZmZzZXRzID0gW107XG4gICAgICAvLyAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtaXRlbXM7IGkrKykge1xuICAgICAgLy8gICAgIGxldCBvZmZzID0gc3RyZWFtLmdldFVpbnQzMkxFKCk7XG4gICAgICAvLyAgICAgcm9vbU9mZnNldHNbaV0gPSBvZmZzO1xuICAgICAgLy8gICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdHJlYW0uZ2V0Qnl0ZXMoc2l6ZSAtIDgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIGdldEJ1bmRsZVN0cmVhbSgpIHtcbiAgLy8gICBsZXQgZmlsZW5hbWUgPSBCVU5ETEVfRklMRTtcbiAgLy8gICBpZiAoIXRoaXMuZmlsZXNbZmlsZW5hbWVdKSByZXR1cm47XG4gIC8vICAgbGV0IHN0cmVhbSA9IG5ldyBCdWZmZXJTdHJlYW0odGhpcy5maWxlc1tmaWxlbmFtZV0pO1xuICAvLyAgIHJldHVybiBzdHJlYW07XG4gIC8vIH1cblxuICBkZWNvbXByZXNzMShiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCkge1xuICAgIGxldCBwaXhlbHMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7XG4gICAgbGV0IG9mZnNldCA9IDA7XG5cbiAgICAvLyBsZXQgY29sb3IgPSBiaXRzLnJlYWQoc2hpZnQpO1xuICAgIGxldCBjb2xvciA9IGJpdHMucmVhZCg4KTtcblxuICAgIGxldCBpbmMgPSAtMTtcblxuICAgIHdoaWxlIChvZmZzZXQgPCB3aWR0aCAqIGhlaWdodCkge1xuICAgICAgcGl4ZWxzW29mZnNldCsrXSA9IGNvbG9yO1xuICAgICAgaWYgKGJpdHMucmVhZCgpKSB7XG4gICAgICAgIGlmICghYml0cy5yZWFkKCkpIHtcbiAgICAgICAgICBjb2xvciA9IGJpdHMucmVhZChzaGlmdCk7XG4gICAgICAgICAgaW5jID0gLTE7XG4gICAgICAgICAgLy8gY29sb3IgPSBiaXRzLnJlYWQoc2hpZnQpO1xuICAgICAgICAgIC8vIGluYyA9IC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghYml0cy5yZWFkKCkpIHtcbiAgICAgICAgICAgIGNvbG9yICs9IGluYztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5jID0gLWluYztcbiAgICAgICAgICAgIGNvbG9yICs9IGluYztcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gaWYgKGJpdHMucmVhZCgpKSBpbmMgPSAtaW5jO1xuICAgICAgICAgIC8vIGNvbG9yICs9IGluYztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBwaXhlbHM7XG4gIH1cblxuICBkZWNvbXByZXNzMihiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCkge1xuICAgIGxldCBwaXhlbHMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7XG4gICAgbGV0IG9mZnNldCA9IDA7XG5cbiAgICAvLyBsZXQgY29sb3IgPSBiaXRzLnJlYWQoc2hpZnQpO1xuICAgIGxldCBjb2xvciA9IGJpdHMucmVhZCg4KTtcbiAgICBsZXQgc2tpcCA9IGZhbHNlO1xuXG4gICAgd2hpbGUgKG9mZnNldCA8IHdpZHRoICogaGVpZ2h0KSB7XG4gICAgICBpZiAoIXNraXApIHtcbiAgICAgICAgcGl4ZWxzW29mZnNldCsrXSA9IGNvbG9yO1xuICAgICAgICBza2lwID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChiaXRzLnJlYWQoKSkge1xuICAgICAgICBpZiAoYml0cy5yZWFkKCkpIHtcbiAgICAgICAgICAvLyBhZGp1c3QgY3VycmVudCBwYWxldHRlIGluZGV4XG4gICAgICAgICAgbGV0IGMgPSBiaXRzLnJlYWQoMyk7XG4gICAgICAgICAgbGV0IGluY20gPSBjIC0gNDtcbiAgICAgICAgICBpZiAoaW5jbSkge1xuICAgICAgICAgICAgY29sb3IgKz0gaW5jbTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3J1bicpO1xuICAgICAgICAgICAgbGV0IHJ1biA9IGJpdHMucmVhZCg4KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVuOyBpKyspIHtcbiAgICAgICAgICAgICAgcGl4ZWxzW29mZnNldCsrXSA9IGNvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2tpcCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHJlYWQgYSBuZXcgcGFsZXR0ZSBpbmRleFxuICAgICAgICAgIGNvbG9yID0gYml0cy5yZWFkKHNoaWZ0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcGl4ZWxzO1xuICB9XG5cbiAgLy9zY2FiLWlzbCAwMTAxMDEwMC4wMTEwMTExMC4xMTAxMTAxMC4wMDExMDEwMC4wMTAwMTEwMVxuXG4gIGRlY29tcHJlc3NTdHJpcChzdHJlYW0sIHdpZHRoLCBoZWlnaHQpIHtcbiAgICBsZXQgY29kZSA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIGxldCBzaGlmdCA9IGNvZGUgJSAxMDtcblxuICAgIGxldCBiaXRzID0gbmV3IEJpdFN0cmVhbShzdHJlYW0pO1xuICAgIGxldCBwaXhlbHM7XG4gICAgbGV0IG9yaWVudGF0aW9uID0gMDtcblxuICAgIGlmIChjb2RlID09IDB4MDEpIHsgLy8gcmF3IGhvcml6b250YWxcbiAgICAgIHBpeGVscyA9IG5ldyBVaW50OEFycmF5KHdpZHRoICogaGVpZ2h0KTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGl4ZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBpeGVsc1tpXSA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChjb2RlID49IDB4MGUgJiYgY29kZSA8PSAweDEyKSB7IC8vIG1ldGhvZCAxIHZlcnRpY2FsXG4gICAgICBvcmllbnRhdGlvbiA9IDE7XG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MxKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDE4ICYmIGNvZGUgPD0gMHgxYykgeyAvLyBtZXRob2QgMSBob3Jpem9udGFsXG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MxKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDIyICYmIGNvZGUgPD0gMHgyNikgeyAvLyBtZXRob2QgMSB2ZXJ0aWNhbCB0cmFuc3BcbiAgICAgIG9yaWVudGF0aW9uID0gMTtcbiAgICAgIHBpeGVscyA9IHRoaXMuZGVjb21wcmVzczEoYml0cywgc2hpZnQsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjb2RlID49IDB4MmMgJiYgY29kZSA8PSAweDMwKSB7IC8vIG1ldGhvZCAxIGhvcml6b250YWwgdHJhbnNwXG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MxKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDQwICYmIGNvZGUgPD0gMHg0NCkgeyAvLyBtZXRob2QgMiBob3Jpem9udGFsXG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MyKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDU0ICYmIGNvZGUgPD0gMHg1OCkgeyAvLyBtZXRob2QgMiBob3Jpem9udGFsIHRyYW5zcFxuICAgICAgcGl4ZWxzID0gdGhpcy5kZWNvbXByZXNzMihiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvZGUgPj0gMHg2OCAmJiBjb2RlIDw9IDB4NmMpIHsgLy8gbWV0aG9kIDIgaG9yaXpvbnRhbCB0cmFuc3BcbiAgICAgIHBpeGVscyA9IHRoaXMuZGVjb21wcmVzczIoYml0cywgc2hpZnQsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjb2RlID49IDB4N2MgJiYgY29kZSA8PSAweDgwKSB7IC8vIG1ldGhvZCAyIGhvcml6b250YWxcbiAgICAgIHBpeGVscyA9IHRoaXMuZGVjb21wcmVzczIoYml0cywgc2hpZnQsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCd1bmtub3duJywgY29kZSk7XG4gICAgfVxuXG4gICAgaWYgKG9yaWVudGF0aW9uKSB7IC8vIHZlcnRpY2FsXG4gICAgICBsZXQgdGVtcCA9IG5ldyBVaW50OEFycmF5KHBpeGVscy5sZW5ndGgpO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGluZGV4ID0gMDsgaSA8IHBpeGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0ZW1wW2luZGV4XSA9IHBpeGVsc1tpXTtcbiAgICAgICAgaW5kZXggKz0gODtcbiAgICAgICAgaWYgKGluZGV4ID49IGhlaWdodCAqIDgpIGluZGV4ID0gKChpIC8gaGVpZ2h0KSA+PiAwKSArIDE7XG4gICAgICB9XG4gICAgICBwaXhlbHMgPSB0ZW1wO1xuICAgIH1cblxuICAgIHJldHVybiBwaXhlbHM7XG4gIH1cblxuICBwYXJzZVNtYXAoc3RyZWFtLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgbGV0IGJhc2UgPSBzdHJlYW0ub2Zmc2V0O1xuXG4gICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG5cbiAgICBpZiAobmFtZSAhPT0gJ1NNQVAnKSByZXR1cm47XG5cbiAgICAvLyBjb25zb2xlLmxvZygnc21hcCcsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgbGV0IG9mZnNldHMgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd2lkdGggLyA4OyBpKyspXG4gICAgICBvZmZzZXRzLnB1c2goc3RyZWFtLmdldFVpbnQzMkxFKCkpO1xuXG4gICAgbGV0IGJpdG1hcCA9IG5ldyBVaW50OEFycmF5KHdpZHRoICogaGVpZ2h0KTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2Zmc2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgc3RyZWFtLnNlZWsoYmFzZSArIG9mZnNldHNbaV0pO1xuICAgICAgbGV0IHBpeGVscyA9IHRoaXMuZGVjb21wcmVzc1N0cmlwKHN0cmVhbSwgOCwgaGVpZ2h0KTtcbiAgICAgIGlmIChwaXhlbHMpIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDAsIHggPSAwLCB5ID0gMDsgaiA8IHBpeGVscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGJpdG1hcFt4ICsgaSAqIDggKyB5ICogd2lkdGhdID0gcGl4ZWxzW2pdO1xuICAgICAgICAgIHkgPSAoeCA9PSA3ID8geSArIDEgOiB5KTtcbiAgICAgICAgICB4ID0gKHggPT0gNyA/IDAgOiB4ICsgMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGksIG9mZnNldHMubGVuZ3RoKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIHJldHVybiBiaXRtYXA7XG4gIH1cblxuICBwYXJzZU9CSU0oc3RyZWFtKSB7XG4gICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgaWYgKG5hbWUgIT09ICdJTUhEJykgcmV0dXJuO1xuICAgIGxldCBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuXG4gICAgbGV0IGlkID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgbGV0IGltbm4gPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBsZXQgenBubiA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIGxldCBmbGFncyA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIHN0cmVhbS5hZHZhbmNlKCk7XG4gICAgbGV0IHggPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBsZXQgeSA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIGxldCB3aWR0aCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIGxldCBoZWlnaHQgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcblxuICAgIGxldCBvYiA9IHtcbiAgICAgIGlkOiBpZCxcbiAgICAgIGltbm46IGltbm4sXG4gICAgICB6cG5uOiB6cG5uLFxuICAgICAgZmxhZ3M6IGZsYWdzLFxuICAgICAgeDogeCxcbiAgICAgIHk6IHksXG4gICAgICB3aWR0aDogd2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlaWdodFxuICAgIH07XG5cbiAgICBpZiAoaW1ubikge1xuICAgICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgICBpZiAobmFtZS5zdWJzdHJpbmcoMCwgMikgPT0gJ0lNJykge1xuICAgICAgICBzdHJlYW0uYWR2YW5jZSg0KTtcbiAgICAgICAgb2IuYml0bWFwID0gdGhpcy5wYXJzZVNtYXAoc3RyZWFtLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb2I7XG4gIH1cblxuICBwYXJzZU9CQ0Qoc3RyZWFtKSB7XG4gICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG4gICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG5cbiAgICBsZXQgaWQgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBsZXQgeCA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIGxldCB5ID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgbGV0IHdpZHRoID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgbGV0IGhlaWdodCA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIGxldCBmbGFncyA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIGxldCBwYXJlbnQgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBsZXQgd2Fsa194ID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgbGV0IHdhbGtfeSA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIGxldCBhY3Rvcl9kaXIgPSBzdHJlYW0uZ2V0VWludDgoKTtcblxuICAgIGxldCBvYiA9IHtcbiAgICAgIGlkOiBpZCxcbiAgICAgIGZsYWdzOiBmbGFncyxcbiAgICAgIHg6IHgsXG4gICAgICB5OiB5LFxuICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICB9O1xuXG4gICAgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuICAgIHN0cmVhbS5hZHZhbmNlKHNpemUgLSA4KTtcblxuICAgIG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIG9iLm5hbWUgPSAnJztcbiAgICBmb3IgKGxldCBiID0gc3RyZWFtLmdldFVpbnQ4KCk7IGIgIT09IDA7IGIgPSBzdHJlYW0uZ2V0VWludDgoKSkge1xuICAgICAgb2IubmFtZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGIpO1xuICAgIH1cblxuICAgIHJldHVybiBvYjtcbiAgfVxuXG4gIHBhcnNlUm9vbShudW0pIHtcbiAgICBsZXQgYmxvY2sgPSB0aGlzLnJvb21zW251bV07XG4gICAgaWYgKCFibG9jaykgcmV0dXJuO1xuXG4gICAgbGV0IHN0cmVhbSA9IG5ldyBCdWZmZXJTdHJlYW0oYmxvY2suYnVmZmVyKTtcblxuICAgIGxldCBlbmQgPSBibG9jay5sZW5ndGg7XG5cbiAgICBsZXQgd2lkdGg7XG4gICAgbGV0IGhlaWdodDtcbiAgICBsZXQgbnVtT2JqZWN0cztcbiAgICBsZXQgcGFsZXR0ZTtcbiAgICBsZXQgYml0bWFwO1xuICAgIGxldCBvYklNcyA9IFtdO1xuICAgIGxldCBvYkNEcyA9IFtdO1xuXG4gICAgd2hpbGUgKHN0cmVhbS5vZmZzZXQgPCBlbmQpIHtcbiAgICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG4gICAgICBsZXQganVtcCA9IHN0cmVhbS5vZmZzZXQgKyBzaXplIC0gODtcblxuICAgICAgaWYgKG5hbWUgPT0gJ1JNSEQnKSB7XG4gICAgICAgIHdpZHRoID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgICAgIGhlaWdodCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgICAgICBudW1PYmplY3RzID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChuYW1lID09ICdSTUlNJykge1xuICAgICAgICBzdHJlYW0uYWR2YW5jZSgxOCk7XG4gICAgICAgIGJpdG1hcCA9IHRoaXMucGFyc2VTbWFwKHN0cmVhbSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChuYW1lID09ICdDTFVUJykge1xuICAgICAgICBwYWxldHRlID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyBpKyspIHtcbiAgICAgICAgICBsZXQgciA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgICAgICAgIGxldCBnID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgICAgICAgbGV0IGIgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgICAgICBwYWxldHRlLnB1c2gociwgZywgYik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG5hbWUgPT0gJ09CSU0nKSB7XG4gICAgICAgIGxldCBvYiA9IHRoaXMucGFyc2VPQklNKHN0cmVhbSk7XG4gICAgICAgIG9iSU1zW29iLmlkXSA9IG9iO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobmFtZSA9PSAnT0JDRCcpIHtcbiAgICAgICAgbGV0IG9iID0gdGhpcy5wYXJzZU9CQ0Qoc3RyZWFtKTtcbiAgICAgICAgb2JDRHNbb2IuaWRdID0gb2I7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gc3RyZWFtLmdldEJ5dGVzKHNpemUgLSA4KTtcbiAgICAgIH1cbiAgICAgIHN0cmVhbS5zZWVrKGp1bXApO1xuICAgIH1cblxuICAgIGxldCByb29tID0gbmV3IFNjdW1tLlJvb20oe1xuICAgICAgaWQ6IG51bSxcbiAgICAgIG5hbWU6IHRoaXMucm9vbU5hbWVzW251bV0sXG4gICAgICB3aWR0aDogd2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgIG51bU9iamVjdHM6IG51bU9iamVjdHMsXG4gICAgICBvYklNczogb2JJTXMsXG4gICAgICBvYkNEczogb2JDRHMsXG4gICAgICBiaXRtYXA6IGJpdG1hcCxcbiAgICAgIHBhbGV0dGU6IHBhbGV0dGVcbiAgICB9KTtcblxuICAgIHJldHVybiByb29tO1xuICB9XG5cbiAgcGFyc2VCdW5kbGUoYnVmZmVyKSB7XG4gICAgY29uc29sZS5sb2coJ3BhcnNlQnVuZGxlJyk7XG5cbiAgICBsZXQgc3RyZWFtID0gbmV3IEJ1ZmZlclN0cmVhbShidWZmZXIpO1xuXG4gICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG5cbiAgICBpZiAobmFtZSAhPSAnTEVDRicpIHJldHVybjtcblxuICAgIG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIGlmIChuYW1lID09ICdMT0ZGJykge1xuICAgICAgdGhpcy5udW1yb29tcyA9IHN0cmVhbS5nZXRVaW50OCgpO1xuXG4gICAgICBsZXQgb2Zmc2V0cyA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubnVtcm9vbXM7IGkrKykge1xuICAgICAgICBsZXQgaWQgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgICAgbGV0IG9mZnMgPSBzdHJlYW0uZ2V0VWludDMyTEUoKTtcbiAgICAgICAgb2Zmc2V0c1tpZF0gPSBvZmZzO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9mZnNldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IG9mZnMgPSBvZmZzZXRzW2ldO1xuICAgICAgICBpZiAob2ZmcyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBzdHJlYW0uc2VlayhvZmZzKTtcbiAgICAgICAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAgICAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcbiAgICAgICAgICB0aGlzLnJvb21zW2ldID0gc3RyZWFtLmdldEJ5dGVzKHNpemUgLSA4KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gUmVzb3VyY2U7XG4iLCJcbnZhciBTY3VtbSA9IHtcbiAgT2JqZWN0OiByZXF1aXJlKCcuL29iamVjdCcpLFxuICBSb29tOiByZXF1aXJlKCcuL3Jvb20nKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNjdW1tO1xuIiwiXG5jbGFzcyBPYmplY3Qge1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICB0aGlzLmlkID0gcGFyYW1zLmlkO1xuICAgIHRoaXMuaW1ubiA9IHBhcmFtcy5pbW5uO1xuICAgIHRoaXMuenBubiA9IHBhcmFtcy56cG5uO1xuICAgIHRoaXMuZmxhZ3MgPSBwYXJhbXMuZmxhZ3M7XG4gICAgdGhpcy54ID0gcGFyYW1zLng7XG4gICAgdGhpcy55ID0gcGFyYW1zLnk7XG4gICAgdGhpcy53aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IHBhcmFtcy5oZWlnaHQ7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3Q7XG4iLCJcbmNsYXNzIFJvb20ge1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICB0aGlzLmlkID0gcGFyYW1zLmlkO1xuICAgIHRoaXMubmFtZSA9IHBhcmFtcy5uYW1lO1xuICAgIHRoaXMud2lkdGggPSBwYXJhbXMud2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBwYXJhbXMuaGVpZ2h0O1xuICAgIHRoaXMubnVtT2JqZWN0cyA9IHBhcmFtcy5udW1PYmplY3RzO1xuICAgIHRoaXMub2JqZWN0cyA9IHBhcmFtcy5vYmplY3RzO1xuICAgIHRoaXMucGFsZXR0ZSA9IHBhcmFtcy5wYWxldHRlO1xuICAgIHRoaXMuYml0bWFwID0gcGFyYW1zLmJpdG1hcDtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJvb207XG4iXX0="}