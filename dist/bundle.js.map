{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/bit_stream.js","src/bitmap.js","src/buffer_stream.js","src/scumm/resource.js","src/scumm/room.js","src/scumm/room_object.js","src/ui/container.js","src/ui/list.js","src/ui/workspace.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","const Container = require('./ui/container');\nconst Workspace = require('./ui/workspace');\nconst List = require('./ui/list');\n\nconst Resource = require('./scumm/resource');\n// const Scumm = require('./scumm');\nconst Bitmap = require('./bitmap');\n\nconst INDEX_FILE = 'monkey2.000';\nconst BUNDLE_FILE = 'monkey2.001';\n\n// const INDEX_FILE = 'mi2demo.000';\n// const BUNDLE_FILE = 'mi2demo.001';\n\nclass App {\n  constructor() {\n    console.log('init');\n\n    this.files = [];\n\n    this.resource = new Resource();\n\n    this.offscreen = document.createElement('canvas');\n    this.offscreen.width = 320;\n    this.offscreen.height = 200;\n\n    this.canvasImages = [];\n\n    this.el = document.getElementById('workspace');\n\n    window.addEventListener('DOMContentLoaded', () => {\n      this.createElements();\n      this.initEventListeners();\n    });\n  }\n\n  decode(buffer, enc=0) {\n    let temp = new Uint8Array(buffer);\n    for (var i = 0; i < temp.length; i++) {\n      temp[i] = temp[i] ^ enc;\n    }\n    return temp.buffer;\n  }\n\n  updatePalette() {\n    let palette = this.palette;\n\n    let paletteEl = this.paletteEl;\n    while(paletteEl.firstChild) paletteEl.removeChild(paletteEl.firstChild);\n\n    if (palette) {\n      for (var i = 0; i < 256; i++) {\n        let r = palette[i*3];\n        let g = palette[i*3 + 1];\n        let b = palette[i*3 + 2];\n        let swatch = document.createElement('div');\n        swatch.classList.add('palette-swatch');\n        swatch.style.backgroundColor = 'rgb(' + r + ',' + g + ',' + b + ')';\n        // swatch.title = 'Index: ' + i + '\\n' + 'RGB: ' + r + ', ' + g + ', ' + b;\n        paletteEl.appendChild(swatch);\n      }\n    }\n  }\n\n  updateRoomImage() {\n    if (!this.room) return;\n    let room = this.room;\n\n    let width = room.width;\n    let height = room.height;\n\n    this.offscreen.width = width;\n    this.offscreen.height = height;\n\n    let ctx = this.offscreen.getContext('2d');\n    ctx.clearRect(0, 0, this.offscreen.width, this.offscreen.height);\n\n    if (room.bitmap) {\n      let imageData = ctx.getImageData(0, 0, width, height);\n\n      for (var i = 0; i < room.bitmap.length; i++) {\n        let index = room.bitmap[i];\n        imageData.data[i * 4 + 0] = this.palette[index * 3 + 0];\n        imageData.data[i * 4 + 1] = this.palette[index * 3 + 1];\n        imageData.data[i * 4 + 2] = this.palette[index * 3 + 2];\n        imageData.data[i * 4 + 3] = 255;\n      }\n\n      ctx.putImageData(imageData, 0, 0);\n\n      for (var i = 0; i < this.canvasImages.length; i++) {\n        let im = this.canvasImages[i];\n        ctx.drawImage(im.image, im.x, im.y);\n      }\n    }\n\n    let scale = 1;\n\n    let canvas = this.canvas;\n    canvas.title = room.name;\n    canvas.width = width * scale;\n    canvas.height = height * scale;\n\n    ctx = canvas.getContext('2d');\n    ctx.imageSmoothingEnabled = false;\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.drawImage(this.offscreen, 0, 0, this.offscreen.width*scale, this.offscreen.height*scale);\n\n    this.imageContainer.setSize(width * scale, height * scale);\n  }\n\n  createCanvasFromBitmap(bitmap, width, height, transparent) {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    if (bitmap) {\n      let ctx = canvas.getContext('2d');\n      let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      for (var i = 0; i < bitmap.length; i++) {\n        let x = i % width;\n        let y = (i / width) >> 0;\n        let index = (y * width + x) * 4;\n        let color = bitmap[i];\n        if (color !== transparent) {\n          imageData.data[index + 0] = this.palette[color * 3 + 0];\n          imageData.data[index + 1] = this.palette[color * 3 + 1];\n          imageData.data[index + 2] = this.palette[color * 3 + 2];\n          imageData.data[index + 3] = 255;\n        }\n      }\n      ctx.putImageData(imageData, 0, 0);\n    }\n    return canvas;\n  }\n\n  updateRoomObjects() {\n    this.roomObjects = this.room.getObjects();\n    let objectsEl = this.roomObjectsEl;\n    while (objectsEl.firstChild) objectsEl.removeChild(objectsEl.firstChild);\n\n    let list = new List({ type: 'icon-list', multiple: true });\n\n    for (var i = 0, index = 1; i < this.roomObjects.length; i++) {\n      let ob = this.roomObjects[i];\n\n      if (ob.bitmaps) {\n        for (var j = 0; j < ob.bitmaps.length; j++) {\n          let bitmap = ob.bitmaps[j];\n          let canvas = this.createCanvasFromBitmap(bitmap, ob.width, ob.height, this.room.transparent);\n          list.addItem({\n            id: index++,\n            title: ob.id,\n            image: canvas,\n            data: ob.id\n          });\n        }\n      }\n    }\n\n    this.roomObjectsList = list;\n\n    this.roomObjectsList.dom().addEventListener('change', (e) => {\n      this.clearCanvasImages();\n      let selection = e.detail.selection;\n      for (var i = 0; i < selection.length; i++) {\n        let item = selection[i];\n        let ob = this.roomObjects.find(element => element.id == item.data);\n        if (ob) {\n          this.addImageToCanvas(item.image, ob.x, ob.y);\n        }\n      }\n      this.updateRoomImage();\n    });\n\n    this.roomObjectsEl.appendChild(list.dom());\n  }\n\n  setRoom(num) {\n    if (this.roomno == num) return;\n    let room = this.resource.getRoom(num);\n    if (room) {\n      this.room = room;\n      this.roomno = num;\n      this.palette = room.palette;\n      this.canvasImages = [];\n\n      this.updatePalette();\n      this.updateRoomImage();\n      this.updateRoomObjects();\n    }\n  }\n\n  addImageToCanvas(image, x, y) {\n    this.canvasImages.push({\n      x: x,\n      y: y,\n      image: image\n    });\n    this.updateRoomImage();\n  }\n\n  clearCanvasImages() {\n    this.canvasImages = [];\n  }\n\n  updateRoomList() {\n    let roomList = this.resource.getRoomList();\n    for (var i = 0; i < roomList.length; i++) {\n      let room = roomList[i];\n      this.roomList.addItem({ id: room.id, title: room.id.toString().padStart(3, '0') + ' ' + room.name });\n    }\n  }\n\n  parseFiles() {\n    if (this.files[INDEX_FILE]) {\n      this.resource.addIndex(this.files[INDEX_FILE]);\n    }\n    if (this.files[BUNDLE_FILE]) {\n      this.resource.addBundle(this.files[BUNDLE_FILE]);\n      this.updateRoomList();\n      this.setRoom(1);\n      this.roomList.select(0);\n    }\n  }\n\n  onFileLoaded(filename) {\n    console.log('Loaded', filename, this.files[filename].byteLength);\n\n    if (filename == INDEX_FILE || filename == BUNDLE_FILE) {\n      this.files[filename] = this.decode(this.files[filename], 0x69);\n    }\n\n    this.filesToLoad--;\n\n    if (this.filesToLoad == 0) {\n      this.parseFiles();\n    }\n  }\n\n  loadFile(file) {\n    var reader = new FileReader();\n    var filename = file.name.toLowerCase();\n\t\treader.onload = (event) => {\n      this.files[filename] = event.target.result;\n      this.onFileLoaded(filename);\n\t\t};\n\t  reader.readAsArrayBuffer(file);\n  }\n\n  onDrop(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    var files = event.dataTransfer.files;\n    if (files.length) {\n      this.filesToLoad = files.length;\n      for (var i = 0; i < files.length; i++) {\n        this.loadFile(files[i]);\n      }\n    }\n  }\n\n  onDragEnter(event) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  onDragOver(event) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  onKeyDown(event) {\n    // console.log(event.target);\n    if (event.key == 'ArrowRight' && !event.repeat) {\n      // this.setRoom(this.roomno + 1);\n    }\n    else if (event.key == 'ArrowLeft' && !event.repeat) {\n      // this.setRoom(this.roomno - 1);\n    }\n  }\n\n  handleEvent(event) {\n    if (event.type == 'drop') {\n      this.onDrop(event);\n    }\n    else if (event.type == 'dragover') {\n      this.onDragOver(event);\n    }\n    else if (event.type == 'dragenter') {\n      this.onDragEnter(event);\n    }\n    else if (event.type == 'keydown') {\n      this.onKeyDown(event);\n    }\n  }\n\n  createElements() {\n    this.app = document.getElementById('app');\n\n    let sidebarEl = document.createElement('div');\n    sidebarEl.classList.add('side-bar');\n\n    this.roomList = new List();\n    this.roomList.dom().addEventListener('change', (e) => {\n      // console.log('change');\n      let selection = e.detail.selection;\n      if (selection.length) {\n        // let id = e.detail.id;\n        this.setRoom(selection[0].id);\n      }\n    });\n\n    this.roomListEl = document.createElement('div');\n    this.roomListEl.classList.add('room-list');\n\n    this.roomListEl.appendChild(this.roomList.dom());\n\n    let el = document.createElement('div');\n    // el.classList.add('room-list-heading');\n    // el.innerHTML = 'Rooms';\n    // sidebarEl.appendChild(el);\n\n    sidebarEl.appendChild(this.roomListEl);\n\n    this.app.appendChild(sidebarEl);\n\n    this.workspace = new Workspace({ parent: this.app });\n\n    this.canvasContainerEl = document.createElement('div');\n    this.canvasContainerEl.classList.add('room-image');\n\n    this.canvas = document.createElement('canvas');\n    this.canvasContainerEl.appendChild(this.canvas);\n\n    this.imageContainer = new Container({ title: 'Background', content: this.canvasContainerEl, x: 32, y: 32, width: 320, height: 200 });\n    this.workspace.add(this.imageContainer);\n\n    this.paletteEl = document.createElement('div');\n    this.paletteEl.classList.add('palette-swatches');\n\n    this.paletteContainer = new Container({ title: 'Palette', content: this.paletteEl, x: 32, y: 280, width: 192, height: 192, status: false });\n    this.workspace.add(this.paletteContainer);\n\n    this.roomObjectsEl = document.createElement('div');\n    this.roomObjectsEl.classList.add('room-objects');\n    this.roomObjectsContainer = new Container({ title: 'Object Images', content: this.roomObjectsEl, x: 256, y: 280, width: 336, height: 278 });\n    this.workspace.add(this.roomObjectsContainer);\n\n\n    this.costumesEl = document.createElement('div');\n    this.costumesEl.classList.add('costumes');\n    this.costumesContainer = new Container({ title: 'Costumes', content: this.costumesEl, x: 624, y: 280, width: 336, height: 278 });\n    this.workspace.add(this.costumesContainer);\n\n  }\n\n  initEventListeners() {\n    window.addEventListener('drop', this, false);\n    window.addEventListener('dragenter', this, false);\n    window.addEventListener('dragover', this, false);\n\n    window.addEventListener('keydown', this, false);\n    window.addEventListener('keyup', this, false);\n  }\n}\n\nmodule.exports = App;\nglobal.App = App;\n","\nclass BitStream {\n  constructor(stream) {\n    this.stream = stream;\n    this.offset = 0;\n    this.cl = 0;\n  }\n\n  next() {\n    this.byte = this.stream.getUint8();\n    this.bit = this.byte & 1;\n    this.cl = 8;\n  }\n\n  shift() {\n    if (this.cl > 1) {\n      this.byte >>= 1;\n      this.bit = this.byte & 1;\n      this.cl--;\n    } else {\n      this.next();\n    }\n  }\n\n  read(length) {\n    if (this.cl == 0) {\n      this.next();\n    }\n\n    if (length) {\n      let value = 0;\n      for (var i = 0; i < length; i++) {\n        value |= (this.bit << i);\n        this.shift();\n      }\n      return value;\n    } else {\n      let value = this.bit ? 1 : 0;\n      this.shift();\n      return value;\n    }\n  }\n}\n\nmodule.exports = BitStream;\n","\nclass Bitmap {\n  constructor(params) {\n    this.width = params.width;\n    this.height = params.height;\n    this.pixels = params.pixels;\n  }\n}\n\nmodule.exports = Bitmap;\n","\nclass BufferStream {\n  constructor(buffer) {\n    this.buffer = buffer;\n    this.view = new DataView(this.buffer);\n    this.offset = 0;\n  }\n\n  get length() {\n    return this.buffer.byteLength;\n  }\n\n  seek(offset=0) {\n    this.offset = offset;\n  }\n\n  advance(count=1) {\n    this.offset += count;\n    if (this.offset > this.buffer.byteLength-1) this.offset = this.buffer.byteLength-1;\n  }\n\n  backup(count=1) {\n    this.offset -= count;\n    if (this.offset < 0) this.offset = 0;\n  }\n\n  getUint8(offset) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset++;\n    }\n    return this.view.getUint8(offset);\n  }\n\n  getUint16(offset, littleEndian=false) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += 2;\n    }\n    return this.view.getUint16(offset, littleEndian);\n  }\n\n  getUint32(offset, littleEndian=false) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += 4;\n    }\n    return this.view.getUint32(offset, littleEndian);\n  }\n\n  getUint16LE(offset) {\n    return this.getUint16(offset, true);\n  }\n\n  getUint32LE(offset) {\n    return this.getUint32(offset, true);\n  }\n\n  getBytes(length=1, offset) {\n    if (offset == undefined) {\n      offset = this.offset;\n      this.offset += length;\n    }\n    let bytes = new Uint8Array(length);\n    for (var i = 0; i < length; i++) {\n      bytes[i] = this.view.getUint8(offset + i); //this.getUint8(offset + i);\n    }\n    return bytes;\n  }\n}\n\nmodule.exports = BufferStream;\n","const BufferStream = require('./../buffer_stream');\nconst BitStream = require('./../bit_stream');\nconst RoomObject = require('./room_object');\nconst Room = require('./room');\n\nclass Resource {\n  constructor() {\n    this.rooms = [];\n    this.roomNames = [];\n    this.diskBlocks = [];\n    this.offsets = {\n      costume: [],\n      room: []\n    };\n  }\n\n  addIndex(buffer) {\n    this.parseIndex(buffer);\n  }\n\n  addBundle(buffer) {\n    this.parseBundle(buffer);\n  }\n\n  getRoom(num) {\n    // console.log('getRoom', num);\n    return this.parseRoom(num);\n  }\n\n  getBlockTypeName(uint32) {\n    return String.fromCharCode(\n      (uint32 & 0xff),\n      ((uint32 >> 8) & 0xff),\n      ((uint32 >> 16) & 0xff),\n      ((uint32 >> 24) & 0xff)\n    );\n  }\n\n  parseBlockName(stream) {\n    let type = stream.getUint32LE();\n    return this.getBlockTypeName(type);\n  }\n\n  parseIndex(buffer) {\n    // console.log('parseIndex');\n    let stream = new BufferStream(buffer);\n\n    while (stream.offset < stream.length) {\n      let name = this.parseBlockName(stream);\n      let size = stream.getUint32();\n      let jmp = stream.offset + size - 8;\n\n      if (name == 'RNAM') { // Room names table\n        while (1) {\n          let roomno = stream.getUint8();\n          if (roomno == 0) break;\n          let bytes = stream.getBytes(9);\n          this.roomNames[roomno] = bytes.reduce((accumulator, currentValue) => {\n            return accumulator + (currentValue != 0xff ? String.fromCharCode(currentValue ^ 0xff) : '');\n          }, '');\n        }\n      }\n      else if (name == 'DCOS') {\n        // console.log('DCOS', size);\n        let num = stream.getUint16LE();\n        // console.log('DCOS', num);\n\n        for (var i = 0; i < num; i++) {\n          let roomno = stream.getUint8();\n          this.offsets.costume[i] = { roomno: roomno };\n        }\n        for (var i = 0; i < num; i++) {\n          let offs = stream.getUint32LE();\n          this.offsets.costume[i].offset = offs;\n          // console.log(offs);\n        }\n        // console.log(this.offsets.costume);\n      }\n      else if (name == 'DROO') {\n      //   let numitems = stream.getUint16LE();\n      //   let roomNos = stream.getBytes(, numitems);\n      //\n      //   let roomOffsets = [];\n      //   for (var i = 0; i < numitems; i++) {\n      //     let offs = stream.getUint32LE();\n      //     roomOffsets[i] = offs;\n      //   }\n\n      }\n      stream.seek(jmp);\n    }\n  }\n\n  decompress1(bits, shift, width, height) {\n    let pixels = new Uint8Array(width * height);\n    let offset = 0;\n\n    let color = bits.read(8);\n\n    let inc = -1;\n\n    while (offset < width * height) {\n      pixels[offset++] = color;\n      if (bits.read()) {\n        if (!bits.read()) {\n          color = bits.read(shift);\n          inc = -1;\n        } else {\n          if (!bits.read()) {\n            color += inc;\n          } else {\n            inc = -inc;\n            color += inc;\n          }\n        }\n      }\n    }\n\n    return pixels;\n  }\n\n  decompress2(bits, shift, width, height) {\n    let pixels = new Uint8Array(width * height);\n    let offset = 0;\n\n    let color = bits.read(8);\n    let skip = false;\n\n    while (offset < width * height) {\n      if (!skip) {\n        pixels[offset++] = color;\n        skip = false;\n      }\n\n      if (bits.read()) {\n        if (bits.read()) {\n          // adjust current palette index\n          let c = bits.read(3);\n          let incm = c - 4;\n          if (incm) {\n            color += incm;\n          } else {\n            let run = bits.read(8);\n            for (var i = 0; i < run; i++) {\n              pixels[offset++] = color;\n            }\n            skip = true;\n          }\n        } else {\n          // read a new palette index\n          color = bits.read(shift);\n        }\n      }\n    }\n    return pixels;\n  }\n\n  decompressStrip(stream, width, height) {\n    let code = stream.getUint8();\n    let shift = code % 10;\n\n    let bits = new BitStream(stream);\n    let pixels;\n    let orientation = 0;\n\n    if (code == 0x01) { // raw horizontal\n      pixels = new Uint8Array(width * height);\n      for (var i = 0; i < pixels.length; i++) {\n        pixels[i] = stream.getUint8();\n      }\n    }\n    else if (code >= 0x0e && code <= 0x12) { // method 1 vertical\n      orientation = 1;\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x18 && code <= 0x1c) { // method 1 horizontal\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x22 && code <= 0x26) { // method 1 vertical transp\n      orientation = 1;\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x2c && code <= 0x30) { // method 1 horizontal transp\n      pixels = this.decompress1(bits, shift, width, height);\n    }\n    else if (code >= 0x40 && code <= 0x44) { // method 2 horizontal\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x54 && code <= 0x58) { // method 2 horizontal transp\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x68 && code <= 0x6c) { // method 2 horizontal transp\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else if (code >= 0x7c && code <= 0x80) { // method 2 horizontal\n      pixels = this.decompress2(bits, shift, width, height);\n    }\n    else {\n      console.log('unknown', code);\n    }\n\n    if (orientation) { // vertical\n      let temp = new Uint8Array(pixels.length);\n      for (var i = 0, index = 0; i < pixels.length; i++) {\n        temp[index] = pixels[i];\n        index += 8;\n        if (index >= height * 8) index = ((i / height) >> 0) + 1;\n      }\n      pixels = temp;\n    }\n\n    return pixels;\n  }\n\n  parseSMAP(stream, width, height) {\n    let base = stream.offset;\n    let name = this.parseBlockName(stream);\n    let size = stream.getUint32();\n\n    if (name !== 'SMAP') return;\n\n    let offsets = [];\n\n    for (var i = 0; i < width / 8; i++)\n      offsets.push(stream.getUint32LE());\n\n    let bitmap = new Uint8Array(width * height);\n\n    for (var i = 0; i < offsets.length; i++) {\n      stream.seek(base + offsets[i]);\n      let pixels = this.decompressStrip(stream, 8, height);\n      if (pixels) {\n        for (var j = 0, x = 0, y = 0; j < pixels.length; j++) {\n          bitmap[x + i * 8 + y * width] = pixels[j];\n          y = (x == 7 ? y + 1 : y);\n          x = (x == 7 ? 0 : x + 1);\n        }\n      }\n\n    }\n\n    return bitmap;\n  }\n\n  parseOBIM(stream) {\n    let name = this.parseBlockName(stream);\n    if (name !== 'OBIM') return;\n    // console.log(name);\n    let size = stream.getUint32();\n\n    name = this.parseBlockName(stream);\n    if (name !== 'IMHD') return;\n    // console.log(name);\n    size = stream.getUint32();\n\n    let ob = {};\n\n    ob.id = stream.getUint16LE();\n    ob.imnn = stream.getUint16LE();\n    ob.zpnn = stream.getUint16LE();\n    ob.flags = stream.getUint8();\n    stream.advance();\n    ob.x = stream.getUint16LE();\n    ob.y = stream.getUint16LE();\n    ob.width = stream.getUint16LE();\n    ob.height = stream.getUint16LE();\n    ob.bitmaps = [];\n\n    if (ob.imnn) {\n      for (var i = 0; i < ob.imnn; i++) {\n        let name = this.parseBlockName(stream);\n        let size = stream.getUint32();\n        let jump = stream.offset + size - 8;\n\n        let bitmap = this.parseSMAP(stream, ob.width, ob.height);\n        ob.bitmaps.push(bitmap);\n        stream.seek(jump);\n      }\n    }\n\n    return ob;\n  }\n\n  parseOBCD(stream) {\n    let name, size;\n\n    name = this.parseBlockName(stream);\n    if (name !== 'OBCD') return;\n    // console.log(name);\n    size = stream.getUint32();\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n\n    let ob = {};\n\n    ob.id = stream.getUint16LE();\n    ob.x = stream.getUint8();\n    ob.y = stream.getUint8();\n    ob.width = stream.getUint8();\n    ob.height = stream.getUint8();\n    ob.flags = stream.getUint8();\n    ob.parent = stream.getUint8();\n    ob.walk_x = stream.getUint16LE();\n    ob.walk_y = stream.getUint16LE();\n    ob.actor_dir = stream.getUint8();\n    ob.name = '';\n\n    // VERB\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n    stream.advance(size - 8);\n\n    // OBNA\n\n    name = this.parseBlockName(stream);\n    size = stream.getUint32();\n    let end = stream.offset + size - 8;\n\n    for (let b = stream.getUint8(); b !== 0 && stream.offset < end; b = stream.getUint8()) {\n      ob.name += String.fromCharCode(b);\n    }\n\n    return ob;\n  }\n\n  parseCOST(stream) {\n    let name = this.parseBlockName(stream);\n    if (name !== 'COST') return;\n    let size = stream.getUint32();\n    console.log(name, stream.length);\n\n    let base = stream.offset - 8 + 2;\n    // let base = stream.offset;\n\n    let numAnim = stream.getUint8();\n    console.log('numAnim', numAnim);\n    let format = stream.getUint8();\n    let numColors = (format & 1 ? 32 : 16);\n\n    // console.log('format', (format & 0x7e).toString(16), format.toString(16));\n\n    let palette = stream.getBytes(numColors);\n\n    stream.advance(2); // skip cmds offset 16bitLE\n\n    let limbOffsets = [];\n    for (var i = 0; i < 16; i++) {\n      let value = stream.getUint16LE();\n      limbOffsets.push(value);\n    }\n    console.log(limbOffsets);\n\n    let animOffsets = []\n    for (var i = 0; i < numAnim; i++) {\n      animOffsets.push(stream.getUint16LE());\n    }\n    console.log(animOffsets);\n\n    let stop;\n\n    for (var i = 0; i < limbOffsets.length; i++) {\n    // for (var i = 0; i < 1; i++) {\n      let offs = limbOffsets[i];\n      if (offs === stop) break;\n\n      stream.seek(base + offs);\n\n      let picOffset = stream.getUint16LE();\n\n      if (base + picOffset < stream.length) {\n        stream.seek(base + picOffset);\n        let width = stream.getUint16LE();\n        let height = stream.getUint16LE();\n        console.log(base + picOffset, picOffset, 'w', width, 'h', height);\n      }\n\n      if (i == 0) stop = picOffset;\n\n      // if (i < limbOffsets.length - 1 && picOffset == limbOffsets[i + 1]) {\n      //   break;\n      // }\n\n    }\n\n    for (var i = 0; i < animOffsets.length; i++) {\n      let offs = animOffsets[i];\n      stream.seek(base + offs);\n      let mask = stream.getUint16LE();\n      // console.log(mask.toString(2).padStart(16, '0'));\n    }\n\n  }\n\n  parseRoom(num) {\n    let block = this.diskBlocks[num - 1];\n    if (!block) return;\n\n    let stream = new BufferStream(block.buffer);\n\n    let width;\n    let height;\n    let numObjects;\n    let palette;\n    let bitmap;\n    let transparent;\n    let obIMs = [];\n    let obCDs = [];\n    let costumes = [];\n\n    let name = this.parseBlockName(stream);\n    if (name !== 'ROOM') return;\n    let size = stream.getUint32();\n\n    // console.log('COSTUME OFFSETS');\n    // let offsets = this.offsets.costume.filter(element => element.roomno == num);\n    // console.log(offsets);\n\n    while (stream.offset < block.length) {\n      let name = this.parseBlockName(stream);\n      let size = stream.getUint32();\n      let jump = stream.offset + size - 8;\n      // console.log(name);\n\n      if (name == 'RMHD') {\n        width = stream.getUint16LE();\n        height = stream.getUint16LE();\n        numObjects = stream.getUint16LE();\n      }\n      else if (name == 'RMIM') {\n        stream.advance(18);\n        bitmap = this.parseSMAP(stream, width, height);\n      }\n      else if (name == 'CLUT') {\n        palette = [];\n        for (var i = 0; i < 256; i++) {\n          let r = stream.getUint8();\n          let g = stream.getUint8();\n          let b = stream.getUint8();\n          palette.push(r, g, b);\n        }\n      }\n      else if (name == 'OBIM') {\n        // console.log('OBIM');\n        stream.backup(8);\n        let ob = this.parseOBIM(stream);\n        obIMs[ob.id] = ob;\n      }\n      else if (name == 'OBCD') {\n        // console.log('OBCD');\n        stream.backup(8);\n        let ob = this.parseOBCD(stream);\n        obCDs[ob.id] = ob;\n      }\n      else if (name == 'TRNS') {\n        transparent = stream.getUint8();\n      }\n      else if (name == 'COST') {\n        stream.backup(8);\n        let costume = this.parseCOST(stream);\n        costumes.push(costume);\n      }\n      else {\n      }\n      stream.seek(jump);\n    }\n\n    let room = new Room({\n      id: num,\n      name: this.roomNames[num],\n      width: width,\n      height: height,\n      numObjects: numObjects,\n      obIMs: obIMs,\n      obCDs: obCDs,\n      palette: palette,\n      bitmap: bitmap,\n      costumes: costumes,\n      transparent: transparent\n    });\n\n    return room;\n  }\n\n  getRoomList() {\n    // console.log('getRoomList');\n    let result = [];\n    for (var i = 0; i < this.numrooms; i++) {\n      // let room = this.rooms[i];\n      // if (room) {\n        result.push({ id: i+1, name: this.roomNames[i+1] });\n      // }\n    }\n    return result;\n  }\n\n  parseBundle(buffer) {\n    // console.log('parseBundle');\n\n    let stream = new BufferStream(buffer);\n\n    let name = this.parseBlockName(stream);\n    let size = stream.getUint32();\n\n    if (name != 'LECF') return;\n    // console.log(name);\n\n    name = this.parseBlockName(stream); // LOFF\n    size = stream.getUint32();\n\n    this.numrooms = stream.getUint8();\n    stream.advance(size - 8 - 1);\n\n    // console.log(name);\n\n    while (stream.offset < stream.length) {\n      let name = this.parseBlockName(stream); // LFLF\n      let size = stream.getUint32();\n\n      // console.log(name);\n      let block = stream.getBytes(size - 8);\n\n      this.diskBlocks.push(block);\n    }\n\n    // if (name == 'LOFF') {\n    //   this.numrooms = stream.getUint8();\n    //\n    //   let offsets = [];\n    //\n    //   for (var i = 0; i < this.numrooms; i++) {\n    //     let roomid = stream.getUint8();\n    //     let offs = stream.getUint32LE();\n    //     offsets[roomid] = offs;\n    //   }\n    //\n    //   // Save out ROOM blocks\n    //\n    //   for (var i = 0; i < offsets.length; i++) {\n    //     let offs = offsets[i];\n    //     if (offs != undefined) {\n    //       stream.seek(offs);\n    //       let name = this.parseBlockName(stream);\n    //       let size = stream.getUint32();\n    //       this.rooms[i] = stream.getBytes(size - 8);\n    //     }\n    //   }\n    //\n    //   // Save out COST blocks\n    //\n    //   // for (var i = 0; i < offsets.length; i++) {\n    //   //   stream.seek(offs - 8);\n    //   //   name = this.parseBlockName(stream);\n    //   //   size = stream.getUint32();\n    //   //\n    //   //   let end = stream.offset + size - 8;\n    //   //\n    //   //   while (stream.offset <= end) {\n    //   //     if (stream.offset + 8 > stream.length) break;\n    //   //     let name = this.parseBlockName(stream);\n    //   //     let size = stream.getUint32();\n    //   //     if (name == 'COST') {\n    //   //       console.log(i, name);\n    //   //     }\n    //   //     stream.advance(size - 8);\n    //   //   }\n    //   // }\n    //\n    // }\n  }\n\n}\n\nmodule.exports = Resource;\n","const RoomObject = require('./room_object');\n\nclass Room {\n  constructor(params) {\n    this.id = params.id;\n    this.name = params.name;\n    this.width = params.width;\n    this.height = params.height;\n    this.numObjects = params.numObjects;\n    this.obIMs = params.obIMs;\n    this.obCDs = params.obCDs;\n    this.palette = params.palette;\n    this.bitmap = params.bitmap;\n    this.costumes = params.costumes;\n    this.transparent = params.transparent;\n  }\n\n  getObjects() {\n    let objects = [];\n    for (var i = 0; i < this.obIMs.length; i++) {\n      let obim = this.obIMs[i];\n      if (obim) {\n        let obcd = this.obCDs[obim.id];\n        let ob = new RoomObject({\n          id: obim.id,\n          name: obcd.name,\n          x: obim.x,\n          y: obim.y,\n          width: obim.width,\n          height: obim.height,\n          bitmaps: obim.bitmaps\n        });\n        objects.push(ob);\n      }\n    }\n    return objects;\n  }\n}\n\nmodule.exports = Room;\n","\nclass RoomObject {\n  constructor(params) {\n    this.id = params.id;\n    this.name = params.name;\n    this.imnn = params.imnn;\n    this.zpnn = params.zpnn;\n    this.flags = params.flags;\n    this.x = params.x;\n    this.y = params.y;\n    this.width = params.width;\n    this.height = params.height;\n    this.bitmaps = params.bitmaps;\n  }\n}\n\nmodule.exports = RoomObject;\n","\nclass Container {\n  constructor(params) {\n    this.parent = params.parent;\n\n    this.el = document.createElement('div');\n    this.el.classList.add('container');\n\n    this.titleEl = document.createElement('div');\n    this.titleEl.id = 'title';\n    this.titleEl.classList.add('container-title');\n    this.titleEl.appendChild(document.createTextNode(params.title));\n    this.el.appendChild(this.titleEl);\n\n    this.contentEl = document.createElement('div');\n    this.contentEl.id = 'content';\n    this.contentEl.classList.add('container-content');\n\n    this.contentEl.appendChild(params.content);\n\n    this.el.appendChild(this.contentEl);\n\n    this.el.style.left = params.x + 'px';\n    this.el.style.top = params.y + 'px';\n\n    // this.contentEl.style.width = params.width + 'px';\n    // this.contentEl.style.height = params.height + 'px';\n    this.setSize(params.width, params.height);\n\n    if (params.status) {\n      let statusEl = document.createElement('div');\n      statusEl.classList.add('container-status');\n      // statusEl.innerHTML = 'Status 1234567890';\n      this.el.appendChild(statusEl);\n    }\n\n    this.el.addEventListener('mousedown', this);\n\n    // this.el.tabIndex = -1;\n  }\n\n  dom() {\n    return this.el;\n  }\n\n  setSize(width, height) {\n    this.contentEl.style.maxWidth = this.contentEl.style.width = width + 'px';\n    this.contentEl.style.maxHeight = this.contentEl.style.height = height + 'px';\n\n  }\n\n  cancelDrag() {\n    window.removeEventListener('mousemove', this);\n    window.removeEventListener('mouseup', this);\n    window.removeEventListener('blur', this);\n  }\n\n  onMouseMove(event) {\n    let x = event.movementX;\n    let y = event.movementY;\n    this.el.style.left = (this.el.offsetLeft + x) + 'px';\n    this.el.style.top = (this.el.offsetTop + y) + 'px';\n  }\n\n  onMouseDown(event) {\n    if (event.button == 0 && event.target === this.titleEl) {\n      window.addEventListener('mousemove', this);\n      window.addEventListener('mouseup', this);\n      window.addEventListener('blur', this);\n    }\n  }\n\n  onMouseUp(event) {\n    this.cancelDrag();\n  }\n\n  onBlur(event) {\n    this.cancelDrag();\n  }\n\n  onBlur(event) {\n    this.cancelDrag();\n  }\n\n  handleEvent(event) {\n    if (event.type == 'mousedown') {\n      this.onMouseDown(event);\n    }\n    else if (event.type == 'mouseup') {\n      this.onMouseUp(event);\n    }\n    else if (event.type == 'mousemove') {\n      this.onMouseMove(event);\n    }\n    else if (event.type == 'focus') {\n      this.onFocus(event);\n    }\n    else if (event.type == 'blur') {\n      this.onBlur(event);\n    }\n  }\n}\n\nmodule.exports = Container;\n","\nclass List {\n  constructor(params={}) {\n    // this.type = params.type == undefined ? 'list' : params.type;\n    this.type = params.type || 'basic-list';\n    this.multiple = params.multiple;\n    this.items = [];\n    this.selection = [];\n\n    this.el = document.createElement('div');\n    this.el.classList.add('list');\n    this.listEl = document.createElement('div');\n    this.listEl.classList.add(this.type);\n    this.el.appendChild(this.listEl);\n\n    this.el.addEventListener('mousedown', this);\n    this.el.addEventListener('keydown', this);\n    this.el.addEventListener('focus', this);\n\n    this.el.tabIndex = -1;\n  }\n\n  createItem(item) {\n    let el = document.createElement('div');\n    el.id = 'item' + item.id;\n    el.dataset.id = item.id;\n\n    if (this.type == 'icon-list') {\n      el.classList.add('icon-list-item');\n\n      let imageEl = document.createElement('div');\n      imageEl.classList.add('icon-list-image');\n      imageEl.appendChild(item.image);\n      el.appendChild(imageEl);\n\n      let titleEl = document.createElement('div');\n      titleEl.classList.add('icon-list-title');\n      titleEl.appendChild(document.createTextNode(item.title));\n      el.appendChild(titleEl);\n    } else {\n      el.classList.add('basic-list-item');\n      el.appendChild(document.createTextNode(item.title));\n    }\n\n    this.listEl.appendChild(el);\n\n    this.items.push(item);\n  }\n\n  addItem(candidate) {\n    if (candidate instanceof Array) {\n      for (var i = 0; i < candidate.length; i++) {\n        let item = candidate[i];\n        this.createItem(item);\n      }\n    } else {\n      this.createItem(candidate);\n    }\n  }\n\n  getItemById(id) {\n    return this.items.find(element => element.id == id);\n  }\n\n  dom() {\n    return this.el;\n  }\n\n  select(index, toggle=false) {\n    let item = this.items[index];\n\n    if (!this.selection.includes(item)) {\n      let el = this.listEl.querySelector('#item' + item.id);\n      if (el) {\n        el.classList.add('selected');\n      }\n      this.selection.push(item);\n      // console.log(el.offsetLeft, el.offsetTop);\n      let left = el.offsetLeft;\n      let top = el.offsetTop;\n      let width = el.offsetWidth;\n      let height = el.offsetHeight;\n      // console.log(this.el.offsetHeight);\n      if (top + height > this.el.scrollTop + this.el.offsetHeight) {\n        // console.log('outside', top+ height);\n        this.el.scrollTop = el.offsetTop - this.el.offsetHeight + height;\n      } else if (top < this.el.scrollTop) {\n        this.el.scrollTop = top;\n      }\n    } else {\n      if (toggle) {\n        this.deselect(index);\n      }\n    }\n\n    // let rect = this.el.getBoundingClientRect();\n    // console.log(rect);\n\n    this.announceChange();\n  }\n\n  deselect(index) {\n    if (index !== undefined) {\n      let item = this.items[index];\n      if (item) {\n        let el = this.listEl.querySelector('#item' + item.id);\n        if (el) {\n          el.classList.remove('selected');\n        }\n        this.selection = this.selection.filter(element => element !== item);\n      }\n    }\n    else {\n      for (var i = 0; i < this.selection.length; i++) {\n        let item = this.selection[i];\n        let el = this.listEl.querySelector('#item' + item.id);\n        if (el) {\n          el.classList.remove('selected');\n        }\n      }\n      this.selection = [];\n    }\n    this.announceChange();\n  }\n\n  selectNext() {\n    let index = 0;\n    if (this.selection.length) {\n      let item = this.selection[this.selection.length - 1];\n      index = this.items.indexOf(item) + 1;\n      if (index > this.items.length - 1) index = this.items.length - 1;\n      this.deselect();\n    }\n    this.select(index);\n    // this.announceChange();\n  }\n\n  selectPrevious() {\n    let index = 0;\n    if (this.selection.length) {\n      let item = this.selection[0];\n      index = this.items.indexOf(item) - 1;\n      if (index < 0) index = 0;\n      this.deselect();\n    }\n    this.select(index);\n    // this.announceChange();\n  }\n\n  announceChange() {\n    var myEvent = new CustomEvent('change', {\n      detail: { selection: this.selection }\n    });\n    this.el.dispatchEvent(myEvent);\n  }\n\n  onMouseDown(event) {\n    if (event.button == 0) {\n      // console.log(event.target.parentNode);\n      // console.log('event.button', event.button);\n      let id = event.target.dataset.id;\n      if (id) {\n        let item = this.getItemById(id);\n        let index = this.items.indexOf(item);\n\n        if (this.multiple) {\n          let toggle = event.metaKey || event.ctrlKey;\n          if (!toggle) this.deselect();\n          this.select(index, toggle);\n        } else {\n          this.deselect();\n          this.select(index);\n        }\n      }\n      else {\n        this.deselect();\n      }\n    }\n  }\n\n  onKeyDown(event) {\n    if (event.key == 'ArrowLeft') {\n      if (this.type == 'icon-list') {\n        this.selectPrevious();\n      }\n    }\n    else if (event.key == 'ArrowRight') {\n      if (this.type == 'icon-list') {\n        this.selectNext();\n      }\n    }\n    else if (event.key == 'ArrowDown') {\n      event.preventDefault();\n      if (this.type == 'basic-list') {\n        this.selectNext();\n      }\n    }\n    else if (event.key == 'ArrowUp') {\n      event.preventDefault();\n      if (this.type == 'basic-list') {\n        this.selectPrevious();\n      }\n    }\n  }\n\n  onFocus(event) {\n    // this.el.style.border = '2px solid red';\n  }\n\n  onBlur(event) {\n    // this.el.style.border = 'initial';\n  }\n\n  handleEvent(event) {\n    if (event.type == 'mousedown') {\n      this.onMouseDown(event);\n    }\n    else if (event.type == 'keydown') {\n      this.onKeyDown(event);\n    }\n    else if (event.type == 'focus') {\n      this.onFocus(event);\n    }\n    else if (event.type == 'blur') {\n      this.onBlur(event);\n    }\n  }\n\n}\n\nmodule.exports = List;\n","\nclass Workspace {\n  constructor(params) {\n    this.el = document.createElement('div');\n    this.el.classList.add('workspace');\n    this.parent = params.parent;\n    this.children = [];\n    this.parent.appendChild(this.el);\n  }\n\n  add(child) {\n    child.z = this.children.length ? this.children[this.children.length - 1].z + 1 : 1;\n    let childEl = child.dom();\n    childEl.addEventListener('mousedown', this);\n    this.el.appendChild(childEl);\n    childEl.style.zIndex = child.z;\n    this.children.push(child);\n  }\n\n  remove(child) {\n    let childEl = child.dom();\n    childEl.removeEventListener('mousedown', this);\n    this.el.removeChild(childEl);\n    this.children = this.children.filter(element => element !== child);\n  }\n\n  bringToFront(child) {\n    child.z = Number.POSITIVE_INFINITY;\n    this.children.sort((a, b) => { return a.z - b.z } );\n    for (var i = 0; i < this.children.length; i++) {\n      let child = this.children[i];\n      child.dom().style.zIndex = child.z = i;\n    }\n  }\n\n  onMouseDown(event) {\n    let temp = event.target;\n\n    while (temp.parentNode && temp.parentNode !== document.body) {\n      if (temp.parentNode === this.el) break;\n      temp = temp.parentNode;\n    }\n\n    let child = this.children.find(element => element.dom() === temp);\n    if (child) {\n      this.bringToFront(child);\n    }\n  }\n\n  handleEvent(event) {\n    if (event.type == 'mousedown') {\n      this.onMouseDown(event);\n    }\n  }\n}\n\nmodule.exports = Workspace;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2JpdF9zdHJlYW0uanMiLCJzcmMvYml0bWFwLmpzIiwic3JjL2J1ZmZlcl9zdHJlYW0uanMiLCJzcmMvc2N1bW0vcmVzb3VyY2UuanMiLCJzcmMvc2N1bW0vcm9vbS5qcyIsInNyYy9zY3VtbS9yb29tX29iamVjdC5qcyIsInNyYy91aS9jb250YWluZXIuanMiLCJzcmMvdWkvbGlzdC5qcyIsInNyYy91aS93b3Jrc3BhY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUEsTUFBTSxZQUFZLFFBQVEsZ0JBQVIsQ0FBbEI7QUFDQSxNQUFNLFlBQVksUUFBUSxnQkFBUixDQUFsQjtBQUNBLE1BQU0sT0FBTyxRQUFRLFdBQVIsQ0FBYjs7QUFFQSxNQUFNLFdBQVcsUUFBUSxrQkFBUixDQUFqQjtBQUNBO0FBQ0EsTUFBTSxTQUFTLFFBQVEsVUFBUixDQUFmOztBQUVBLE1BQU0sYUFBYSxhQUFuQjtBQUNBLE1BQU0sY0FBYyxhQUFwQjs7QUFFQTtBQUNBOztBQUVBLE1BQU0sR0FBTixDQUFVO0FBQ1IsZ0JBQWM7QUFDWixZQUFRLEdBQVIsQ0FBWSxNQUFaOztBQUVBLFNBQUssS0FBTCxHQUFhLEVBQWI7O0FBRUEsU0FBSyxRQUFMLEdBQWdCLElBQUksUUFBSixFQUFoQjs7QUFFQSxTQUFLLFNBQUwsR0FBaUIsU0FBUyxhQUFULENBQXVCLFFBQXZCLENBQWpCO0FBQ0EsU0FBSyxTQUFMLENBQWUsS0FBZixHQUF1QixHQUF2QjtBQUNBLFNBQUssU0FBTCxDQUFlLE1BQWYsR0FBd0IsR0FBeEI7O0FBRUEsU0FBSyxZQUFMLEdBQW9CLEVBQXBCOztBQUVBLFNBQUssRUFBTCxHQUFVLFNBQVMsY0FBVCxDQUF3QixXQUF4QixDQUFWOztBQUVBLFdBQU8sZ0JBQVAsQ0FBd0Isa0JBQXhCLEVBQTRDLE1BQU07QUFDaEQsV0FBSyxjQUFMO0FBQ0EsV0FB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akIsUUFBSSxPQUFPLE1BQU0sTUFBakI7O0FBRUEsV0FBTyxLQUFLLFVBQUwsSUFBbUIsS0FBSyxVQUFMLEtBQW9CLFNBQVMsSUFBdkQsRUFBNkQ7QUFDM0QsVUFBSSxLQUFLLFVBQUwsS0FBb0IsS0FBSyxFQUE3QixFQUFpQztBQUNqQyxhQUFPLEtBQUssVUFBWjtBQUNEOztBQUVELFFBQUksUUFBUSxLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLFdBQVcsUUFBUSxHQUFSLE9BQWtCLElBQWhELENBQVo7QUFDQSxRQUFJLEtBQUosRUFBVztBQUNULFdBQUssWUFBTCxDQUFrQixLQUFsQjtBQUNEO0FBQ0Y7O0FBRUQsY0FBWSxLQUFaLEVBQW1CO0FBQ2pCLFFBQUksTUFBTSxJQUFOLElBQWMsV0FBbEIsRUFBK0I7QUFDN0IsV0FBSyxXQUFMLENBQWlCLEtBQWpCO0FBQ0Q7QUFDRjtBQXBEYTs7QUF1RGhCLE9BQU8sT0FBUCxHQUFpQixTQUFqQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiY29uc3QgQ29udGFpbmVyID0gcmVxdWlyZSgnLi91aS9jb250YWluZXInKTtcbmNvbnN0IFdvcmtzcGFjZSA9IHJlcXVpcmUoJy4vdWkvd29ya3NwYWNlJyk7XG5jb25zdCBMaXN0ID0gcmVxdWlyZSgnLi91aS9saXN0Jyk7XG5cbmNvbnN0IFJlc291cmNlID0gcmVxdWlyZSgnLi9zY3VtbS9yZXNvdXJjZScpO1xuLy8gY29uc3QgU2N1bW0gPSByZXF1aXJlKCcuL3NjdW1tJyk7XG5jb25zdCBCaXRtYXAgPSByZXF1aXJlKCcuL2JpdG1hcCcpO1xuXG5jb25zdCBJTkRFWF9GSUxFID0gJ21vbmtleTIuMDAwJztcbmNvbnN0IEJVTkRMRV9GSUxFID0gJ21vbmtleTIuMDAxJztcblxuLy8gY29uc3QgSU5ERVhfRklMRSA9ICdtaTJkZW1vLjAwMCc7XG4vLyBjb25zdCBCVU5ETEVfRklMRSA9ICdtaTJkZW1vLjAwMSc7XG5cbmNsYXNzIEFwcCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGNvbnNvbGUubG9nKCdpbml0Jyk7XG5cbiAgICB0aGlzLmZpbGVzID0gW107XG5cbiAgICB0aGlzLnJlc291cmNlID0gbmV3IFJlc291cmNlKCk7XG5cbiAgICB0aGlzLm9mZnNjcmVlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIHRoaXMub2Zmc2NyZWVuLndpZHRoID0gMzIwO1xuICAgIHRoaXMub2Zmc2NyZWVuLmhlaWdodCA9IDIwMDtcblxuICAgIHRoaXMuY2FudmFzSW1hZ2VzID0gW107XG5cbiAgICB0aGlzLmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvcmtzcGFjZScpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLmNyZWF0ZUVsZW1lbnRzKCk7XG4gICAgICB0aGlzLmluaXRFdmVudExpc3RlbmVycygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVjb2RlKGJ1ZmZlciwgZW5jPTApIHtcbiAgICBsZXQgdGVtcCA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZW1wLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0ZW1wW2ldID0gdGVtcFtpXSBeIGVuYztcbiAgICB9XG4gICAgcmV0dXJuIHRlbXAuYnVmZmVyO1xuICB9XG5cbiAgdXBkYXRlUGFsZXR0ZSgpIHtcbiAgICBsZXQgcGFsZXR0ZSA9IHRoaXMucGFsZXR0ZTtcblxuICAgIGxldCBwYWxldHRlRWwgPSB0aGlzLnBhbGV0dGVFbDtcbiAgICB3aGlsZShwYWxldHRlRWwuZmlyc3RDaGlsZCkgcGFsZXR0ZUVsLnJlbW92ZUNoaWxkKHBhbGV0dGVFbC5maXJzdENoaWxkKTtcblxuICAgIGlmIChwYWxldHRlKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgaSsrKSB7XG4gICAgICAgIGxldCByID0gcGFsZXR0ZVtpKjNdO1xuICAgICAgICBsZXQgZyA9IHBhbGV0dGVbaSozICsgMV07XG4gICAgICAgIGxldCBiID0gcGFsZXR0ZVtpKjMgKyAyXTtcbiAgICAgICAgbGV0IHN3YXRjaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBzd2F0Y2guY2xhc3NMaXN0LmFkZCgncGFsZXR0ZS1zd2F0Y2gnKTtcbiAgICAgICAgc3dhdGNoLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoJyArIHIgKyAnLCcgKyBnICsgJywnICsgYiArICcpJztcbiAgICAgICAgLy8gc3dhdGNoLnRpdGxlID0gJ0luZGV4OiAnICsgaSArICdcXG4nICsgJ1JHQjogJyArIHIgKyAnLCAnICsgZyArICcsICcgKyBiO1xuICAgICAgICBwYWxldHRlRWwuYXBwZW5kQ2hpbGQoc3dhdGNoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGRhdGVSb29tSW1hZ2UoKSB7XG4gICAgaWYgKCF0aGlzLnJvb20pIHJldHVybjtcbiAgICBsZXQgcm9vbSA9IHRoaXMucm9vbTtcblxuICAgIGxldCB3aWR0aCA9IHJvb20ud2lkdGg7XG4gICAgbGV0IGhlaWdodCA9IHJvb20uaGVpZ2h0O1xuXG4gICAgdGhpcy5vZmZzY3JlZW4ud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLm9mZnNjcmVlbi5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICBsZXQgY3R4ID0gdGhpcy5vZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMub2Zmc2NyZWVuLndpZHRoLCB0aGlzLm9mZnNjcmVlbi5oZWlnaHQpO1xuXG4gICAgaWYgKHJvb20uYml0bWFwKSB7XG4gICAgICBsZXQgaW1hZ2VEYXRhID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb29tLmJpdG1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgaW5kZXggPSByb29tLmJpdG1hcFtpXTtcbiAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyAwXSA9IHRoaXMucGFsZXR0ZVtpbmRleCAqIDMgKyAwXTtcbiAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyAxXSA9IHRoaXMucGFsZXR0ZVtpbmRleCAqIDMgKyAxXTtcbiAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyAyXSA9IHRoaXMucGFsZXR0ZVtpbmRleCAqIDMgKyAyXTtcbiAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyAzXSA9IDI1NTtcbiAgICAgIH1cblxuICAgICAgY3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2FudmFzSW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBpbSA9IHRoaXMuY2FudmFzSW1hZ2VzW2ldO1xuICAgICAgICBjdHguZHJhd0ltYWdlKGltLmltYWdlLCBpbS54LCBpbS55KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgc2NhbGUgPSAxO1xuXG4gICAgbGV0IGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuICAgIGNhbnZhcy50aXRsZSA9IHJvb20ubmFtZTtcbiAgICBjYW52YXMud2lkdGggPSB3aWR0aCAqIHNjYWxlO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQgKiBzY2FsZTtcblxuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGN0eC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gICAgY3R4LmRyYXdJbWFnZSh0aGlzLm9mZnNjcmVlbiwgMCwgMCwgdGhpcy5vZmZzY3JlZW4ud2lkdGgqc2NhbGUsIHRoaXMub2Zmc2NyZWVuLmhlaWdodCpzY2FsZSk7XG5cbiAgICB0aGlzLmltYWdlQ29udGFpbmVyLnNldFNpemUod2lkdGggKiBzY2FsZSwgaGVpZ2h0ICogc2NhbGUpO1xuICB9XG5cbiAgY3JlYXRlQ2FudmFzRnJvbUJpdG1hcChiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIHRyYW5zcGFyZW50KSB7XG4gICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgaWYgKGJpdG1hcCkge1xuICAgICAgbGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgbGV0IGltYWdlRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYml0bWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCB4ID0gaSAlIHdpZHRoO1xuICAgICAgICBsZXQgeSA9IChpIC8gd2lkdGgpID4+IDA7XG4gICAgICAgIGxldCBpbmRleCA9ICh5ICogd2lkdGggKyB4KSAqIDQ7XG4gICAgICAgIGxldCBjb2xvciA9IGJpdG1hcFtpXTtcbiAgICAgICAgaWYgKGNvbG9yICE9PSB0cmFuc3BhcmVudCkge1xuICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMF0gPSB0aGlzLnBhbGV0dGVbY29sb3IgKiAzICsgMF07XG4gICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAxXSA9IHRoaXMucGFsZXR0ZVtjb2xvciAqIDMgKyAxXTtcbiAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDJdID0gdGhpcy5wYWxldHRlW2NvbG9yICogMyArIDJdO1xuICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgM10gPSAyNTU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhbnZhcztcbiAgfVxuXG4gIHVwZGF0ZVJvb21PYmplY3RzKCkge1xuICAgIHRoaXMucm9vbU9iamVjdHMgPSB0aGlzLnJvb20uZ2V0T2JqZWN0cygpO1xuICAgIGxldCBvYmplY3RzRWwgPSB0aGlzLnJvb21PYmplY3RzRWw7XG4gICAgd2hpbGUgKG9iamVjdHNFbC5maXJzdENoaWxkKSBvYmplY3RzRWwucmVtb3ZlQ2hpbGQob2JqZWN0c0VsLmZpcnN0Q2hpbGQpO1xuXG4gICAgbGV0IGxpc3QgPSBuZXcgTGlzdCh7IHR5cGU6ICdpY29uLWxpc3QnLCBtdWx0aXBsZTogdHJ1ZSB9KTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBpbmRleCA9IDE7IGkgPCB0aGlzLnJvb21PYmplY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgb2IgPSB0aGlzLnJvb21PYmplY3RzW2ldO1xuXG4gICAgICBpZiAob2IuYml0bWFwcykge1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG9iLmJpdG1hcHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBsZXQgYml0bWFwID0gb2IuYml0bWFwc1tqXTtcbiAgICAgICAgICBsZXQgY2FudmFzID0gdGhpcy5jcmVhdGVDYW52YXNGcm9tQml0bWFwKGJpdG1hcCwgb2Iud2lkdGgsIG9iLmhlaWdodCwgdGhpcy5yb29tLnRyYW5zcGFyZW50KTtcbiAgICAgICAgICBsaXN0LmFkZEl0ZW0oe1xuICAgICAgICAgICAgaWQ6IGluZGV4KyssXG4gICAgICAgICAgICB0aXRsZTogb2IuaWQsXG4gICAgICAgICAgICBpbWFnZTogY2FudmFzLFxuICAgICAgICAgICAgZGF0YTogb2IuaWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMucm9vbU9iamVjdHNMaXN0ID0gbGlzdDtcblxuICAgIHRoaXMucm9vbU9iamVjdHNMaXN0LmRvbSgpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICB0aGlzLmNsZWFyQ2FudmFzSW1hZ2VzKCk7XG4gICAgICBsZXQgc2VsZWN0aW9uID0gZS5kZXRhaWwuc2VsZWN0aW9uO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGl0ZW0gPSBzZWxlY3Rpb25baV07XG4gICAgICAgIGxldCBvYiA9IHRoaXMucm9vbU9iamVjdHMuZmluZChlbGVtZW50ID0+IGVsZW1lbnQuaWQgPT0gaXRlbS5kYXRhKTtcbiAgICAgICAgaWYgKG9iKSB7XG4gICAgICAgICAgdGhpcy5hZGRJbWFnZVRvQ2FudmFzKGl0ZW0uaW1hZ2UsIG9iLngsIG9iLnkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZVJvb21JbWFnZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yb29tT2JqZWN0c0VsLmFwcGVuZENoaWxkKGxpc3QuZG9tKCkpO1xuICB9XG5cbiAgc2V0Um9vbShudW0pIHtcbiAgICBpZiAodGhpcy5yb29tbm8gPT0gbnVtKSByZXR1cm47XG4gICAgbGV0IHJvb20gPSB0aGlzLnJlc291cmNlLmdldFJvb20obnVtKTtcbiAgICBpZiAocm9vbSkge1xuICAgICAgdGhpcy5yb29tID0gcm9vbTtcbiAgICAgIHRoaXMucm9vbW5vID0gbnVtO1xuICAgICAgdGhpcy5wYWxldHRlID0gcm9vbS5wYWxldHRlO1xuICAgICAgdGhpcy5jYW52YXNJbWFnZXMgPSBbXTtcblxuICAgICAgdGhpcy51cGRhdGVQYWxldHRlKCk7XG4gICAgICB0aGlzLnVwZGF0ZVJvb21JbWFnZSgpO1xuICAgICAgdGhpcy51cGRhdGVSb29tT2JqZWN0cygpO1xuICAgIH1cbiAgfVxuXG4gIGFkZEltYWdlVG9DYW52YXMoaW1hZ2UsIHgsIHkpIHtcbiAgICB0aGlzLmNhbnZhc0ltYWdlcy5wdXNoKHtcbiAgICAgIHg6IHgsXG4gICAgICB5OiB5LFxuICAgICAgaW1hZ2U6IGltYWdlXG4gICAgfSk7XG4gICAgdGhpcy51cGRhdGVSb29tSW1hZ2UoKTtcbiAgfVxuXG4gIGNsZWFyQ2FudmFzSW1hZ2VzKCkge1xuICAgIHRoaXMuY2FudmFzSW1hZ2VzID0gW107XG4gIH1cblxuICB1cGRhdGVSb29tTGlzdCgpIHtcbiAgICBsZXQgcm9vbUxpc3QgPSB0aGlzLnJlc291cmNlLmdldFJvb21MaXN0KCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb29tTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHJvb20gPSByb29tTGlzdFtpXTtcbiAgICAgIHRoaXMucm9vbUxpc3QuYWRkSXRlbSh7IGlkOiByb29tLmlkLCB0aXRsZTogcm9vbS5pZC50b1N0cmluZygpLnBhZFN0YXJ0KDMsICcwJykgKyAnICcgKyByb29tLm5hbWUgfSk7XG4gICAgfVxuICB9XG5cbiAgcGFyc2VGaWxlcygpIHtcbiAgICBpZiAodGhpcy5maWxlc1tJTkRFWF9GSUxFXSkge1xuICAgICAgdGhpcy5yZXNvdXJjZS5hZGRJbmRleCh0aGlzLmZpbGVzW0lOREVYX0ZJTEVdKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZmlsZXNbQlVORExFX0ZJTEVdKSB7XG4gICAgICB0aGlzLnJlc291cmNlLmFkZEJ1bmRsZSh0aGlzLmZpbGVzW0JVTkRMRV9GSUxFXSk7XG4gICAgICB0aGlzLnVwZGF0ZVJvb21MaXN0KCk7XG4gICAgICB0aGlzLnNldFJvb20oMSk7XG4gICAgICB0aGlzLnJvb21MaXN0LnNlbGVjdCgwKTtcbiAgICB9XG4gIH1cblxuICBvbkZpbGVMb2FkZWQoZmlsZW5hbWUpIHtcbiAgICBjb25zb2xlLmxvZygnTG9hZGVkJywgZmlsZW5hbWUsIHRoaXMuZmlsZXNbZmlsZW5hbWVdLmJ5dGVMZW5ndGgpO1xuXG4gICAgaWYgKGZpbGVuYW1lID09IElOREVYX0ZJTEUgfHwgZmlsZW5hbWUgPT0gQlVORExFX0ZJTEUpIHtcbiAgICAgIHRoaXMuZmlsZXNbZmlsZW5hbWVdID0gdGhpcy5kZWNvZGUodGhpcy5maWxlc1tmaWxlbmFtZV0sIDB4NjkpO1xuICAgIH1cblxuICAgIHRoaXMuZmlsZXNUb0xvYWQtLTtcblxuICAgIGlmICh0aGlzLmZpbGVzVG9Mb2FkID09IDApIHtcbiAgICAgIHRoaXMucGFyc2VGaWxlcygpO1xuICAgIH1cbiAgfVxuXG4gIGxvYWRGaWxlKGZpbGUpIHtcbiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICB2YXIgZmlsZW5hbWUgPSBmaWxlLm5hbWUudG9Mb3dlckNhc2UoKTtcblx0XHRyZWFkZXIub25sb2FkID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmZpbGVzW2ZpbGVuYW1lXSA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICB0aGlzLm9uRmlsZUxvYWRlZChmaWxlbmFtZSk7XG5cdFx0fTtcblx0ICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7XG4gIH1cblxuICBvbkRyb3AoZXZlbnQpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdmFyIGZpbGVzID0gZXZlbnQuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICAgIGlmIChmaWxlcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuZmlsZXNUb0xvYWQgPSBmaWxlcy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMubG9hZEZpbGUoZmlsZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG9uRHJhZ0VudGVyKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfVxuXG4gIG9uRHJhZ092ZXIoZXZlbnQpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cbiAgb25LZXlEb3duKGV2ZW50KSB7XG4gICAgLy8gY29uc29sZS5sb2coZXZlbnQudGFyZ2V0KTtcbiAgICBpZiAoZXZlbnQua2V5ID09ICdBcnJvd1JpZ2h0JyAmJiAhZXZlbnQucmVwZWF0KSB7XG4gICAgICAvLyB0aGlzLnNldFJvb20odGhpcy5yb29tbm8gKyAxKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQua2V5ID09ICdBcnJvd0xlZnQnICYmICFldmVudC5yZXBlYXQpIHtcbiAgICAgIC8vIHRoaXMuc2V0Um9vbSh0aGlzLnJvb21ubyAtIDEpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUV2ZW50KGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnR5cGUgPT0gJ2Ryb3AnKSB7XG4gICAgICB0aGlzLm9uRHJvcChldmVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT0gJ2RyYWdvdmVyJykge1xuICAgICAgdGhpcy5vbkRyYWdPdmVyKGV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PSAnZHJhZ2VudGVyJykge1xuICAgICAgdGhpcy5vbkRyYWdFbnRlcihldmVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT0gJ2tleWRvd24nKSB7XG4gICAgICB0aGlzLm9uS2V5RG93bihldmVudCk7XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlRWxlbWVudHMoKSB7XG4gICAgdGhpcy5hcHAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwJyk7XG5cbiAgICBsZXQgc2lkZWJhckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgc2lkZWJhckVsLmNsYXNzTGlzdC5hZGQoJ3NpZGUtYmFyJyk7XG5cbiAgICB0aGlzLnJvb21MaXN0ID0gbmV3IExpc3QoKTtcbiAgICB0aGlzLnJvb21MaXN0LmRvbSgpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICAvLyBjb25zb2xlLmxvZygnY2hhbmdlJyk7XG4gICAgICBsZXQgc2VsZWN0aW9uID0gZS5kZXRhaWwuc2VsZWN0aW9uO1xuICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgLy8gbGV0IGlkID0gZS5kZXRhaWwuaWQ7XG4gICAgICAgIHRoaXMuc2V0Um9vbShzZWxlY3Rpb25bMF0uaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5yb29tTGlzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5yb29tTGlzdEVsLmNsYXNzTGlzdC5hZGQoJ3Jvb20tbGlzdCcpO1xuXG4gICAgdGhpcy5yb29tTGlzdEVsLmFwcGVuZENoaWxkKHRoaXMucm9vbUxpc3QuZG9tKCkpO1xuXG4gICAgbGV0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgLy8gZWwuY2xhc3NMaXN0LmFkZCgncm9vbS1saXN0LWhlYWRpbmcnKTtcbiAgICAvLyBlbC5pbm5lckhUTUwgPSAnUm9vbXMnO1xuICAgIC8vIHNpZGViYXJFbC5hcHBlbmRDaGlsZChlbCk7XG5cbiAgICBzaWRlYmFyRWwuYXBwZW5kQ2hpbGQodGhpcy5yb29tTGlzdEVsKTtcblxuICAgIHRoaXMuYXBwLmFwcGVuZENoaWxkKHNpZGViYXJFbCk7XG5cbiAgICB0aGlzLndvcmtzcGFjZSA9IG5ldyBXb3Jrc3BhY2UoeyBwYXJlbnQ6IHRoaXMuYXBwIH0pO1xuXG4gICAgdGhpcy5jYW52YXNDb250YWluZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuY2FudmFzQ29udGFpbmVyRWwuY2xhc3NMaXN0LmFkZCgncm9vbS1pbWFnZScpO1xuXG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICB0aGlzLmNhbnZhc0NvbnRhaW5lckVsLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcblxuICAgIHRoaXMuaW1hZ2VDb250YWluZXIgPSBuZXcgQ29udGFpbmVyKHsgdGl0bGU6ICdCYWNrZ3JvdW5kJywgY29udGVudDogdGhpcy5jYW52YXNDb250YWluZXJFbCwgeDogMzIsIHk6IDMyLCB3aWR0aDogMzIwLCBoZWlnaHQ6IDIwMCB9KTtcbiAgICB0aGlzLndvcmtzcGFjZS5hZGQodGhpcy5pbWFnZUNvbnRhaW5lcik7XG5cbiAgICB0aGlzLnBhbGV0dGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMucGFsZXR0ZUVsLmNsYXNzTGlzdC5hZGQoJ3BhbGV0dGUtc3dhdGNoZXMnKTtcblxuICAgIHRoaXMucGFsZXR0ZUNvbnRhaW5lciA9IG5ldyBDb250YWluZXIoeyB0aXRsZTogJ1BhbGV0dGUnLCBjb250ZW50OiB0aGlzLnBhbGV0dGVFbCwgeDogMzIsIHk6IDI4MCwgd2lkdGg6IDE5MiwgaGVpZ2h0OiAxOTIsIHN0YXR1czogZmFsc2UgfSk7XG4gICAgdGhpcy53b3Jrc3BhY2UuYWRkKHRoaXMucGFsZXR0ZUNvbnRhaW5lcik7XG5cbiAgICB0aGlzLnJvb21PYmplY3RzRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLnJvb21PYmplY3RzRWwuY2xhc3NMaXN0LmFkZCgncm9vbS1vYmplY3RzJyk7XG4gICAgdGhpcy5yb29tT2JqZWN0c0NvbnRhaW5lciA9IG5ldyBDb250YWluZXIoeyB0aXRsZTogJ09iamVjdCBJbWFnZXMnLCBjb250ZW50OiB0aGlzLnJvb21PYmplY3RzRWwsIHg6IDI1NiwgeTogMjgwLCB3aWR0aDogMzM2LCBoZWlnaHQ6IDI3OCB9KTtcbiAgICB0aGlzLndvcmtzcGFjZS5hZGQodGhpcy5yb29tT2JqZWN0c0NvbnRhaW5lcik7XG5cblxuICAgIHRoaXMuY29zdHVtZXNFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuY29zdHVtZXNFbC5jbGFzc0xpc3QuYWRkKCdjb3N0dW1lcycpO1xuICAgIHRoaXMuY29zdHVtZXNDb250YWluZXIgPSBuZXcgQ29udGFpbmVyKHsgdGl0bGU6ICdDb3N0dW1lcycsIGNvbnRlbnQ6IHRoaXMuY29zdHVtZXNFbCwgeDogNjI0LCB5OiAyODAsIHdpZHRoOiAzMzYsIGhlaWdodDogMjc4IH0pO1xuICAgIHRoaXMud29ya3NwYWNlLmFkZCh0aGlzLmNvc3R1bWVzQ29udGFpbmVyKTtcblxuICB9XG5cbiAgaW5pdEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcywgZmFsc2UpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW50ZXInLCB0aGlzLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcywgZmFsc2UpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcywgZmFsc2UpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQXBwO1xuZ2xvYmFsLkFwcCA9IEFwcDtcbiIsIlxuY2xhc3MgQml0U3RyZWFtIHtcbiAgY29uc3RydWN0b3Ioc3RyZWFtKSB7XG4gICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07XG4gICAgdGhpcy5vZmZzZXQgPSAwO1xuICAgIHRoaXMuY2wgPSAwO1xuICB9XG5cbiAgbmV4dCgpIHtcbiAgICB0aGlzLmJ5dGUgPSB0aGlzLnN0cmVhbS5nZXRVaW50OCgpO1xuICAgIHRoaXMuYml0ID0gdGhpcy5ieXRlICYgMTtcbiAgICB0aGlzLmNsID0gODtcbiAgfVxuXG4gIHNoaWZ0KCkge1xuICAgIGlmICh0aGlzLmNsID4gMSkge1xuICAgICAgdGhpcy5ieXRlID4+PSAxO1xuICAgICAgdGhpcy5iaXQgPSB0aGlzLmJ5dGUgJiAxO1xuICAgICAgdGhpcy5jbC0tO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5leHQoKTtcbiAgICB9XG4gIH1cblxuICByZWFkKGxlbmd0aCkge1xuICAgIGlmICh0aGlzLmNsID09IDApIHtcbiAgICAgIHRoaXMubmV4dCgpO1xuICAgIH1cblxuICAgIGlmIChsZW5ndGgpIHtcbiAgICAgIGxldCB2YWx1ZSA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhbHVlIHw9ICh0aGlzLmJpdCA8PCBpKTtcbiAgICAgICAgdGhpcy5zaGlmdCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgdmFsdWUgPSB0aGlzLmJpdCA/IDEgOiAwO1xuICAgICAgdGhpcy5zaGlmdCgpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEJpdFN0cmVhbTtcbiIsIlxuY2xhc3MgQml0bWFwIHtcbiAgY29uc3RydWN0b3IocGFyYW1zKSB7XG4gICAgdGhpcy53aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IHBhcmFtcy5oZWlnaHQ7XG4gICAgdGhpcy5waXhlbHMgPSBwYXJhbXMucGl4ZWxzO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQml0bWFwO1xuIiwiXG5jbGFzcyBCdWZmZXJTdHJlYW0ge1xuICBjb25zdHJ1Y3RvcihidWZmZXIpIHtcbiAgICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICB0aGlzLnZpZXcgPSBuZXcgRGF0YVZpZXcodGhpcy5idWZmZXIpO1xuICAgIHRoaXMub2Zmc2V0ID0gMDtcbiAgfVxuXG4gIGdldCBsZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGg7XG4gIH1cblxuICBzZWVrKG9mZnNldD0wKSB7XG4gICAgdGhpcy5vZmZzZXQgPSBvZmZzZXQ7XG4gIH1cblxuICBhZHZhbmNlKGNvdW50PTEpIHtcbiAgICB0aGlzLm9mZnNldCArPSBjb3VudDtcbiAgICBpZiAodGhpcy5vZmZzZXQgPiB0aGlzLmJ1ZmZlci5ieXRlTGVuZ3RoLTEpIHRoaXMub2Zmc2V0ID0gdGhpcy5idWZmZXIuYnl0ZUxlbmd0aC0xO1xuICB9XG5cbiAgYmFja3VwKGNvdW50PTEpIHtcbiAgICB0aGlzLm9mZnNldCAtPSBjb3VudDtcbiAgICBpZiAodGhpcy5vZmZzZXQgPCAwKSB0aGlzLm9mZnNldCA9IDA7XG4gIH1cblxuICBnZXRVaW50OChvZmZzZXQpIHtcbiAgICBpZiAob2Zmc2V0ID09IHVuZGVmaW5lZCkge1xuICAgICAgb2Zmc2V0ID0gdGhpcy5vZmZzZXQ7XG4gICAgICB0aGlzLm9mZnNldCsrO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy52aWV3LmdldFVpbnQ4KG9mZnNldCk7XG4gIH1cblxuICBnZXRVaW50MTYob2Zmc2V0LCBsaXR0bGVFbmRpYW49ZmFsc2UpIHtcbiAgICBpZiAob2Zmc2V0ID09IHVuZGVmaW5lZCkge1xuICAgICAgb2Zmc2V0ID0gdGhpcy5vZmZzZXQ7XG4gICAgICB0aGlzLm9mZnNldCArPSAyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy52aWV3LmdldFVpbnQxNihvZmZzZXQsIGxpdHRsZUVuZGlhbik7XG4gIH1cblxuICBnZXRVaW50MzIob2Zmc2V0LCBsaXR0bGVFbmRpYW49ZmFsc2UpIHtcbiAgICBpZiAob2Zmc2V0ID09IHVuZGVmaW5lZCkge1xuICAgICAgb2Zmc2V0ID0gdGhpcy5vZmZzZXQ7XG4gICAgICB0aGlzLm9mZnNldCArPSA0O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy52aWV3LmdldFVpbnQzMihvZmZzZXQsIGxpdHRsZUVuZGlhbik7XG4gIH1cblxuICBnZXRVaW50MTZMRShvZmZzZXQpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRVaW50MTYob2Zmc2V0LCB0cnVlKTtcbiAgfVxuXG4gIGdldFVpbnQzMkxFKG9mZnNldCkge1xuICAgIHJldHVybiB0aGlzLmdldFVpbnQzMihvZmZzZXQsIHRydWUpO1xuICB9XG5cbiAgZ2V0Qnl0ZXMobGVuZ3RoPTEsIG9mZnNldCkge1xuICAgIGlmIChvZmZzZXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldDtcbiAgICAgIHRoaXMub2Zmc2V0ICs9IGxlbmd0aDtcbiAgICB9XG4gICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBieXRlc1tpXSA9IHRoaXMudmlldy5nZXRVaW50OChvZmZzZXQgKyBpKTsgLy90aGlzLmdldFVpbnQ4KG9mZnNldCArIGkpO1xuICAgIH1cbiAgICByZXR1cm4gYnl0ZXM7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCdWZmZXJTdHJlYW07XG4iLCJjb25zdCBCdWZmZXJTdHJlYW0gPSByZXF1aXJlKCcuLy4uL2J1ZmZlcl9zdHJlYW0nKTtcbmNvbnN0IEJpdFN0cmVhbSA9IHJlcXVpcmUoJy4vLi4vYml0X3N0cmVhbScpO1xuY29uc3QgUm9vbU9iamVjdCA9IHJlcXVpcmUoJy4vcm9vbV9vYmplY3QnKTtcbmNvbnN0IFJvb20gPSByZXF1aXJlKCcuL3Jvb20nKTtcblxuY2xhc3MgUmVzb3VyY2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJvb21zID0gW107XG4gICAgdGhpcy5yb29tTmFtZXMgPSBbXTtcbiAgICB0aGlzLmRpc2tCbG9ja3MgPSBbXTtcbiAgICB0aGlzLm9mZnNldHMgPSB7XG4gICAgICBjb3N0dW1lOiBbXSxcbiAgICAgIHJvb206IFtdXG4gICAgfTtcbiAgfVxuXG4gIGFkZEluZGV4KGJ1ZmZlcikge1xuICAgIHRoaXMucGFyc2VJbmRleChidWZmZXIpO1xuICB9XG5cbiAgYWRkQnVuZGxlKGJ1ZmZlcikge1xuICAgIHRoaXMucGFyc2VCdW5kbGUoYnVmZmVyKTtcbiAgfVxuXG4gIGdldFJvb20obnVtKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ2dldFJvb20nLCBudW0pO1xuICAgIHJldHVybiB0aGlzLnBhcnNlUm9vbShudW0pO1xuICB9XG5cbiAgZ2V0QmxvY2tUeXBlTmFtZSh1aW50MzIpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShcbiAgICAgICh1aW50MzIgJiAweGZmKSxcbiAgICAgICgodWludDMyID4+IDgpICYgMHhmZiksXG4gICAgICAoKHVpbnQzMiA+PiAxNikgJiAweGZmKSxcbiAgICAgICgodWludDMyID4+IDI0KSAmIDB4ZmYpXG4gICAgKTtcbiAgfVxuXG4gIHBhcnNlQmxvY2tOYW1lKHN0cmVhbSkge1xuICAgIGxldCB0eXBlID0gc3RyZWFtLmdldFVpbnQzMkxFKCk7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QmxvY2tUeXBlTmFtZSh0eXBlKTtcbiAgfVxuXG4gIHBhcnNlSW5kZXgoYnVmZmVyKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ3BhcnNlSW5kZXgnKTtcbiAgICBsZXQgc3RyZWFtID0gbmV3IEJ1ZmZlclN0cmVhbShidWZmZXIpO1xuXG4gICAgd2hpbGUgKHN0cmVhbS5vZmZzZXQgPCBzdHJlYW0ubGVuZ3RoKSB7XG4gICAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAgIGxldCBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuICAgICAgbGV0IGptcCA9IHN0cmVhbS5vZmZzZXQgKyBzaXplIC0gODtcblxuICAgICAgaWYgKG5hbWUgPT0gJ1JOQU0nKSB7IC8vIFJvb20gbmFtZXMgdGFibGVcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBsZXQgcm9vbW5vID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgICAgICAgaWYgKHJvb21ubyA9PSAwKSBicmVhaztcbiAgICAgICAgICBsZXQgYnl0ZXMgPSBzdHJlYW0uZ2V0Qnl0ZXMoOSk7XG4gICAgICAgICAgdGhpcy5yb29tTmFtZXNbcm9vbW5vXSA9IGJ5dGVzLnJlZHVjZSgoYWNjdW11bGF0b3IsIGN1cnJlbnRWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yICsgKGN1cnJlbnRWYWx1ZSAhPSAweGZmID8gU3RyaW5nLmZyb21DaGFyQ29kZShjdXJyZW50VmFsdWUgXiAweGZmKSA6ICcnKTtcbiAgICAgICAgICB9LCAnJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG5hbWUgPT0gJ0RDT1MnKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdEQ09TJywgc2l6ZSk7XG4gICAgICAgIGxldCBudW0gPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0RDT1MnLCBudW0pO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtOyBpKyspIHtcbiAgICAgICAgICBsZXQgcm9vbW5vID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgICAgICAgdGhpcy5vZmZzZXRzLmNvc3R1bWVbaV0gPSB7IHJvb21ubzogcm9vbW5vIH07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW07IGkrKykge1xuICAgICAgICAgIGxldCBvZmZzID0gc3RyZWFtLmdldFVpbnQzMkxFKCk7XG4gICAgICAgICAgdGhpcy5vZmZzZXRzLmNvc3R1bWVbaV0ub2Zmc2V0ID0gb2ZmcztcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhvZmZzKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLm9mZnNldHMuY29zdHVtZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChuYW1lID09ICdEUk9PJykge1xuICAgICAgLy8gICBsZXQgbnVtaXRlbXMgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICAgIC8vICAgbGV0IHJvb21Ob3MgPSBzdHJlYW0uZ2V0Qnl0ZXMoLCBudW1pdGVtcyk7XG4gICAgICAvL1xuICAgICAgLy8gICBsZXQgcm9vbU9mZnNldHMgPSBbXTtcbiAgICAgIC8vICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1pdGVtczsgaSsrKSB7XG4gICAgICAvLyAgICAgbGV0IG9mZnMgPSBzdHJlYW0uZ2V0VWludDMyTEUoKTtcbiAgICAgIC8vICAgICByb29tT2Zmc2V0c1tpXSA9IG9mZnM7XG4gICAgICAvLyAgIH1cblxuICAgICAgfVxuICAgICAgc3RyZWFtLnNlZWsoam1wKTtcbiAgICB9XG4gIH1cblxuICBkZWNvbXByZXNzMShiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCkge1xuICAgIGxldCBwaXhlbHMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7XG4gICAgbGV0IG9mZnNldCA9IDA7XG5cbiAgICBsZXQgY29sb3IgPSBiaXRzLnJlYWQoOCk7XG5cbiAgICBsZXQgaW5jID0gLTE7XG5cbiAgICB3aGlsZSAob2Zmc2V0IDwgd2lkdGggKiBoZWlnaHQpIHtcbiAgICAgIHBpeGVsc1tvZmZzZXQrK10gPSBjb2xvcjtcbiAgICAgIGlmIChiaXRzLnJlYWQoKSkge1xuICAgICAgICBpZiAoIWJpdHMucmVhZCgpKSB7XG4gICAgICAgICAgY29sb3IgPSBiaXRzLnJlYWQoc2hpZnQpO1xuICAgICAgICAgIGluYyA9IC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghYml0cy5yZWFkKCkpIHtcbiAgICAgICAgICAgIGNvbG9yICs9IGluYztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5jID0gLWluYztcbiAgICAgICAgICAgIGNvbG9yICs9IGluYztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcGl4ZWxzO1xuICB9XG5cbiAgZGVjb21wcmVzczIoYml0cywgc2hpZnQsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICBsZXQgcGl4ZWxzID0gbmV3IFVpbnQ4QXJyYXkod2lkdGggKiBoZWlnaHQpO1xuICAgIGxldCBvZmZzZXQgPSAwO1xuXG4gICAgbGV0IGNvbG9yID0gYml0cy5yZWFkKDgpO1xuICAgIGxldCBza2lwID0gZmFsc2U7XG5cbiAgICB3aGlsZSAob2Zmc2V0IDwgd2lkdGggKiBoZWlnaHQpIHtcbiAgICAgIGlmICghc2tpcCkge1xuICAgICAgICBwaXhlbHNbb2Zmc2V0KytdID0gY29sb3I7XG4gICAgICAgIHNraXAgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJpdHMucmVhZCgpKSB7XG4gICAgICAgIGlmIChiaXRzLnJlYWQoKSkge1xuICAgICAgICAgIC8vIGFkanVzdCBjdXJyZW50IHBhbGV0dGUgaW5kZXhcbiAgICAgICAgICBsZXQgYyA9IGJpdHMucmVhZCgzKTtcbiAgICAgICAgICBsZXQgaW5jbSA9IGMgLSA0O1xuICAgICAgICAgIGlmIChpbmNtKSB7XG4gICAgICAgICAgICBjb2xvciArPSBpbmNtO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcnVuID0gYml0cy5yZWFkKDgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydW47IGkrKykge1xuICAgICAgICAgICAgICBwaXhlbHNbb2Zmc2V0KytdID0gY29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBza2lwID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gcmVhZCBhIG5ldyBwYWxldHRlIGluZGV4XG4gICAgICAgICAgY29sb3IgPSBiaXRzLnJlYWQoc2hpZnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwaXhlbHM7XG4gIH1cblxuICBkZWNvbXByZXNzU3RyaXAoc3RyZWFtLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgbGV0IGNvZGUgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBsZXQgc2hpZnQgPSBjb2RlICUgMTA7XG5cbiAgICBsZXQgYml0cyA9IG5ldyBCaXRTdHJlYW0oc3RyZWFtKTtcbiAgICBsZXQgcGl4ZWxzO1xuICAgIGxldCBvcmllbnRhdGlvbiA9IDA7XG5cbiAgICBpZiAoY29kZSA9PSAweDAxKSB7IC8vIHJhdyBob3Jpem9udGFsXG4gICAgICBwaXhlbHMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBpeGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBwaXhlbHNbaV0gPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDBlICYmIGNvZGUgPD0gMHgxMikgeyAvLyBtZXRob2QgMSB2ZXJ0aWNhbFxuICAgICAgb3JpZW50YXRpb24gPSAxO1xuICAgICAgcGl4ZWxzID0gdGhpcy5kZWNvbXByZXNzMShiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvZGUgPj0gMHgxOCAmJiBjb2RlIDw9IDB4MWMpIHsgLy8gbWV0aG9kIDEgaG9yaXpvbnRhbFxuICAgICAgcGl4ZWxzID0gdGhpcy5kZWNvbXByZXNzMShiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvZGUgPj0gMHgyMiAmJiBjb2RlIDw9IDB4MjYpIHsgLy8gbWV0aG9kIDEgdmVydGljYWwgdHJhbnNwXG4gICAgICBvcmllbnRhdGlvbiA9IDE7XG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MxKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDJjICYmIGNvZGUgPD0gMHgzMCkgeyAvLyBtZXRob2QgMSBob3Jpem9udGFsIHRyYW5zcFxuICAgICAgcGl4ZWxzID0gdGhpcy5kZWNvbXByZXNzMShiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvZGUgPj0gMHg0MCAmJiBjb2RlIDw9IDB4NDQpIHsgLy8gbWV0aG9kIDIgaG9yaXpvbnRhbFxuICAgICAgcGl4ZWxzID0gdGhpcy5kZWNvbXByZXNzMihiaXRzLCBzaGlmdCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvZGUgPj0gMHg1NCAmJiBjb2RlIDw9IDB4NTgpIHsgLy8gbWV0aG9kIDIgaG9yaXpvbnRhbCB0cmFuc3BcbiAgICAgIHBpeGVscyA9IHRoaXMuZGVjb21wcmVzczIoYml0cywgc2hpZnQsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjb2RlID49IDB4NjggJiYgY29kZSA8PSAweDZjKSB7IC8vIG1ldGhvZCAyIGhvcml6b250YWwgdHJhbnNwXG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MyKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA+PSAweDdjICYmIGNvZGUgPD0gMHg4MCkgeyAvLyBtZXRob2QgMiBob3Jpem9udGFsXG4gICAgICBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3MyKGJpdHMsIHNoaWZ0LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygndW5rbm93bicsIGNvZGUpO1xuICAgIH1cblxuICAgIGlmIChvcmllbnRhdGlvbikgeyAvLyB2ZXJ0aWNhbFxuICAgICAgbGV0IHRlbXAgPSBuZXcgVWludDhBcnJheShwaXhlbHMubGVuZ3RoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBpbmRleCA9IDA7IGkgPCBwaXhlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGVtcFtpbmRleF0gPSBwaXhlbHNbaV07XG4gICAgICAgIGluZGV4ICs9IDg7XG4gICAgICAgIGlmIChpbmRleCA+PSBoZWlnaHQgKiA4KSBpbmRleCA9ICgoaSAvIGhlaWdodCkgPj4gMCkgKyAxO1xuICAgICAgfVxuICAgICAgcGl4ZWxzID0gdGVtcDtcbiAgICB9XG5cbiAgICByZXR1cm4gcGl4ZWxzO1xuICB9XG5cbiAgcGFyc2VTTUFQKHN0cmVhbSwgd2lkdGgsIGhlaWdodCkge1xuICAgIGxldCBiYXNlID0gc3RyZWFtLm9mZnNldDtcbiAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIGlmIChuYW1lICE9PSAnU01BUCcpIHJldHVybjtcblxuICAgIGxldCBvZmZzZXRzID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdpZHRoIC8gODsgaSsrKVxuICAgICAgb2Zmc2V0cy5wdXNoKHN0cmVhbS5nZXRVaW50MzJMRSgpKTtcblxuICAgIGxldCBiaXRtYXAgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9mZnNldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN0cmVhbS5zZWVrKGJhc2UgKyBvZmZzZXRzW2ldKTtcbiAgICAgIGxldCBwaXhlbHMgPSB0aGlzLmRlY29tcHJlc3NTdHJpcChzdHJlYW0sIDgsIGhlaWdodCk7XG4gICAgICBpZiAocGl4ZWxzKSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwLCB4ID0gMCwgeSA9IDA7IGogPCBwaXhlbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBiaXRtYXBbeCArIGkgKiA4ICsgeSAqIHdpZHRoXSA9IHBpeGVsc1tqXTtcbiAgICAgICAgICB5ID0gKHggPT0gNyA/IHkgKyAxIDogeSk7XG4gICAgICAgICAgeCA9ICh4ID09IDcgPyAwIDogeCArIDEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICByZXR1cm4gYml0bWFwO1xuICB9XG5cbiAgcGFyc2VPQklNKHN0cmVhbSkge1xuICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgIGlmIChuYW1lICE9PSAnT0JJTScpIHJldHVybjtcbiAgICAvLyBjb25zb2xlLmxvZyhuYW1lKTtcbiAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgaWYgKG5hbWUgIT09ICdJTUhEJykgcmV0dXJuO1xuICAgIC8vIGNvbnNvbGUubG9nKG5hbWUpO1xuICAgIHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG5cbiAgICBsZXQgb2IgPSB7fTtcblxuICAgIG9iLmlkID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgb2IuaW1ubiA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIG9iLnpwbm4gPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBvYi5mbGFncyA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIHN0cmVhbS5hZHZhbmNlKCk7XG4gICAgb2IueCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIG9iLnkgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBvYi53aWR0aCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIG9iLmhlaWdodCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgIG9iLmJpdG1hcHMgPSBbXTtcblxuICAgIGlmIChvYi5pbW5uKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iLmltbm47IGkrKykge1xuICAgICAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAgICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG4gICAgICAgIGxldCBqdW1wID0gc3RyZWFtLm9mZnNldCArIHNpemUgLSA4O1xuXG4gICAgICAgIGxldCBiaXRtYXAgPSB0aGlzLnBhcnNlU01BUChzdHJlYW0sIG9iLndpZHRoLCBvYi5oZWlnaHQpO1xuICAgICAgICBvYi5iaXRtYXBzLnB1c2goYml0bWFwKTtcbiAgICAgICAgc3RyZWFtLnNlZWsoanVtcCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iO1xuICB9XG5cbiAgcGFyc2VPQkNEKHN0cmVhbSkge1xuICAgIGxldCBuYW1lLCBzaXplO1xuXG4gICAgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICBpZiAobmFtZSAhPT0gJ09CQ0QnKSByZXR1cm47XG4gICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG4gICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIGxldCBvYiA9IHt9O1xuXG4gICAgb2IuaWQgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBvYi54ID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgb2IueSA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgIG9iLndpZHRoID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgb2IuaGVpZ2h0ID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgb2IuZmxhZ3MgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBvYi5wYXJlbnQgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBvYi53YWxrX3ggPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBvYi53YWxrX3kgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICBvYi5hY3Rvcl9kaXIgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBvYi5uYW1lID0gJyc7XG5cbiAgICAvLyBWRVJCXG5cbiAgICBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgIHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG4gICAgc3RyZWFtLmFkdmFuY2Uoc2l6ZSAtIDgpO1xuXG4gICAgLy8gT0JOQVxuXG4gICAgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuICAgIGxldCBlbmQgPSBzdHJlYW0ub2Zmc2V0ICsgc2l6ZSAtIDg7XG5cbiAgICBmb3IgKGxldCBiID0gc3RyZWFtLmdldFVpbnQ4KCk7IGIgIT09IDAgJiYgc3RyZWFtLm9mZnNldCA8IGVuZDsgYiA9IHN0cmVhbS5nZXRVaW50OCgpKSB7XG4gICAgICBvYi5uYW1lICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iO1xuICB9XG5cbiAgcGFyc2VDT1NUKHN0cmVhbSkge1xuICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgIGlmIChuYW1lICE9PSAnQ09TVCcpIHJldHVybjtcbiAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcbiAgICBjb25zb2xlLmxvZyhuYW1lLCBzdHJlYW0ubGVuZ3RoKTtcblxuICAgIGxldCBiYXNlID0gc3RyZWFtLm9mZnNldCAtIDggKyAyO1xuICAgIC8vIGxldCBiYXNlID0gc3RyZWFtLm9mZnNldDtcblxuICAgIGxldCBudW1BbmltID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgY29uc29sZS5sb2coJ251bUFuaW0nLCBudW1BbmltKTtcbiAgICBsZXQgZm9ybWF0ID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgbGV0IG51bUNvbG9ycyA9IChmb3JtYXQgJiAxID8gMzIgOiAxNik7XG5cbiAgICAvLyBjb25zb2xlLmxvZygnZm9ybWF0JywgKGZvcm1hdCAmIDB4N2UpLnRvU3RyaW5nKDE2KSwgZm9ybWF0LnRvU3RyaW5nKDE2KSk7XG5cbiAgICBsZXQgcGFsZXR0ZSA9IHN0cmVhbS5nZXRCeXRlcyhudW1Db2xvcnMpO1xuXG4gICAgc3RyZWFtLmFkdmFuY2UoMik7IC8vIHNraXAgY21kcyBvZmZzZXQgMTZiaXRMRVxuXG4gICAgbGV0IGxpbWJPZmZzZXRzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICBsZXQgdmFsdWUgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICAgIGxpbWJPZmZzZXRzLnB1c2godmFsdWUpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhsaW1iT2Zmc2V0cyk7XG5cbiAgICBsZXQgYW5pbU9mZnNldHMgPSBbXVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQW5pbTsgaSsrKSB7XG4gICAgICBhbmltT2Zmc2V0cy5wdXNoKHN0cmVhbS5nZXRVaW50MTZMRSgpKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coYW5pbU9mZnNldHMpO1xuXG4gICAgbGV0IHN0b3A7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbWJPZmZzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gZm9yICh2YXIgaSA9IDA7IGkgPCAxOyBpKyspIHtcbiAgICAgIGxldCBvZmZzID0gbGltYk9mZnNldHNbaV07XG4gICAgICBpZiAob2ZmcyA9PT0gc3RvcCkgYnJlYWs7XG5cbiAgICAgIHN0cmVhbS5zZWVrKGJhc2UgKyBvZmZzKTtcblxuICAgICAgbGV0IHBpY09mZnNldCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuXG4gICAgICBpZiAoYmFzZSArIHBpY09mZnNldCA8IHN0cmVhbS5sZW5ndGgpIHtcbiAgICAgICAgc3RyZWFtLnNlZWsoYmFzZSArIHBpY09mZnNldCk7XG4gICAgICAgIGxldCB3aWR0aCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgICAgICBsZXQgaGVpZ2h0ID0gc3RyZWFtLmdldFVpbnQxNkxFKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGJhc2UgKyBwaWNPZmZzZXQsIHBpY09mZnNldCwgJ3cnLCB3aWR0aCwgJ2gnLCBoZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaSA9PSAwKSBzdG9wID0gcGljT2Zmc2V0O1xuXG4gICAgICAvLyBpZiAoaSA8IGxpbWJPZmZzZXRzLmxlbmd0aCAtIDEgJiYgcGljT2Zmc2V0ID09IGxpbWJPZmZzZXRzW2kgKyAxXSkge1xuICAgICAgLy8gICBicmVhaztcbiAgICAgIC8vIH1cblxuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbU9mZnNldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBvZmZzID0gYW5pbU9mZnNldHNbaV07XG4gICAgICBzdHJlYW0uc2VlayhiYXNlICsgb2Zmcyk7XG4gICAgICBsZXQgbWFzayA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgICAgLy8gY29uc29sZS5sb2cobWFzay50b1N0cmluZygyKS5wYWRTdGFydCgxNiwgJzAnKSk7XG4gICAgfVxuXG4gIH1cblxuICBwYXJzZVJvb20obnVtKSB7XG4gICAgbGV0IGJsb2NrID0gdGhpcy5kaXNrQmxvY2tzW251bSAtIDFdO1xuICAgIGlmICghYmxvY2spIHJldHVybjtcblxuICAgIGxldCBzdHJlYW0gPSBuZXcgQnVmZmVyU3RyZWFtKGJsb2NrLmJ1ZmZlcik7XG5cbiAgICBsZXQgd2lkdGg7XG4gICAgbGV0IGhlaWdodDtcbiAgICBsZXQgbnVtT2JqZWN0cztcbiAgICBsZXQgcGFsZXR0ZTtcbiAgICBsZXQgYml0bWFwO1xuICAgIGxldCB0cmFuc3BhcmVudDtcbiAgICBsZXQgb2JJTXMgPSBbXTtcbiAgICBsZXQgb2JDRHMgPSBbXTtcbiAgICBsZXQgY29zdHVtZXMgPSBbXTtcblxuICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgIGlmIChuYW1lICE9PSAnUk9PTScpIHJldHVybjtcbiAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIC8vIGNvbnNvbGUubG9nKCdDT1NUVU1FIE9GRlNFVFMnKTtcbiAgICAvLyBsZXQgb2Zmc2V0cyA9IHRoaXMub2Zmc2V0cy5jb3N0dW1lLmZpbHRlcihlbGVtZW50ID0+IGVsZW1lbnQucm9vbW5vID09IG51bSk7XG4gICAgLy8gY29uc29sZS5sb2cob2Zmc2V0cyk7XG5cbiAgICB3aGlsZSAoc3RyZWFtLm9mZnNldCA8IGJsb2NrLmxlbmd0aCkge1xuICAgICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcbiAgICAgIGxldCBqdW1wID0gc3RyZWFtLm9mZnNldCArIHNpemUgLSA4O1xuICAgICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG5cbiAgICAgIGlmIChuYW1lID09ICdSTUhEJykge1xuICAgICAgICB3aWR0aCA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgICAgICBoZWlnaHQgPSBzdHJlYW0uZ2V0VWludDE2TEUoKTtcbiAgICAgICAgbnVtT2JqZWN0cyA9IHN0cmVhbS5nZXRVaW50MTZMRSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobmFtZSA9PSAnUk1JTScpIHtcbiAgICAgICAgc3RyZWFtLmFkdmFuY2UoMTgpO1xuICAgICAgICBiaXRtYXAgPSB0aGlzLnBhcnNlU01BUChzdHJlYW0sIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobmFtZSA9PSAnQ0xVVCcpIHtcbiAgICAgICAgcGFsZXR0ZSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgaSsrKSB7XG4gICAgICAgICAgbGV0IHIgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgICAgICBsZXQgZyA9IHN0cmVhbS5nZXRVaW50OCgpO1xuICAgICAgICAgIGxldCBiID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgICAgICAgcGFsZXR0ZS5wdXNoKHIsIGcsIGIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChuYW1lID09ICdPQklNJykge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnT0JJTScpO1xuICAgICAgICBzdHJlYW0uYmFja3VwKDgpO1xuICAgICAgICBsZXQgb2IgPSB0aGlzLnBhcnNlT0JJTShzdHJlYW0pO1xuICAgICAgICBvYklNc1tvYi5pZF0gPSBvYjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG5hbWUgPT0gJ09CQ0QnKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdPQkNEJyk7XG4gICAgICAgIHN0cmVhbS5iYWNrdXAoOCk7XG4gICAgICAgIGxldCBvYiA9IHRoaXMucGFyc2VPQkNEKHN0cmVhbSk7XG4gICAgICAgIG9iQ0RzW29iLmlkXSA9IG9iO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobmFtZSA9PSAnVFJOUycpIHtcbiAgICAgICAgdHJhbnNwYXJlbnQgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG5hbWUgPT0gJ0NPU1QnKSB7XG4gICAgICAgIHN0cmVhbS5iYWNrdXAoOCk7XG4gICAgICAgIGxldCBjb3N0dW1lID0gdGhpcy5wYXJzZUNPU1Qoc3RyZWFtKTtcbiAgICAgICAgY29zdHVtZXMucHVzaChjb3N0dW1lKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgfVxuICAgICAgc3RyZWFtLnNlZWsoanVtcCk7XG4gICAgfVxuXG4gICAgbGV0IHJvb20gPSBuZXcgUm9vbSh7XG4gICAgICBpZDogbnVtLFxuICAgICAgbmFtZTogdGhpcy5yb29tTmFtZXNbbnVtXSxcbiAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgbnVtT2JqZWN0czogbnVtT2JqZWN0cyxcbiAgICAgIG9iSU1zOiBvYklNcyxcbiAgICAgIG9iQ0RzOiBvYkNEcyxcbiAgICAgIHBhbGV0dGU6IHBhbGV0dGUsXG4gICAgICBiaXRtYXA6IGJpdG1hcCxcbiAgICAgIGNvc3R1bWVzOiBjb3N0dW1lcyxcbiAgICAgIHRyYW5zcGFyZW50OiB0cmFuc3BhcmVudFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJvb207XG4gIH1cblxuICBnZXRSb29tTGlzdCgpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnZ2V0Um9vbUxpc3QnKTtcbiAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm51bXJvb21zOyBpKyspIHtcbiAgICAgIC8vIGxldCByb29tID0gdGhpcy5yb29tc1tpXTtcbiAgICAgIC8vIGlmIChyb29tKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHsgaWQ6IGkrMSwgbmFtZTogdGhpcy5yb29tTmFtZXNbaSsxXSB9KTtcbiAgICAgIC8vIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHBhcnNlQnVuZGxlKGJ1ZmZlcikge1xuICAgIC8vIGNvbnNvbGUubG9nKCdwYXJzZUJ1bmRsZScpO1xuXG4gICAgbGV0IHN0cmVhbSA9IG5ldyBCdWZmZXJTdHJlYW0oYnVmZmVyKTtcblxuICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pO1xuICAgIGxldCBzaXplID0gc3RyZWFtLmdldFVpbnQzMigpO1xuXG4gICAgaWYgKG5hbWUgIT0gJ0xFQ0YnKSByZXR1cm47XG4gICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG5cbiAgICBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pOyAvLyBMT0ZGXG4gICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgIHRoaXMubnVtcm9vbXMgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICBzdHJlYW0uYWR2YW5jZShzaXplIC0gOCAtIDEpO1xuXG4gICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG5cbiAgICB3aGlsZSAoc3RyZWFtLm9mZnNldCA8IHN0cmVhbS5sZW5ndGgpIHtcbiAgICAgIGxldCBuYW1lID0gdGhpcy5wYXJzZUJsb2NrTmFtZShzdHJlYW0pOyAvLyBMRkxGXG4gICAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcblxuICAgICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG4gICAgICBsZXQgYmxvY2sgPSBzdHJlYW0uZ2V0Qnl0ZXMoc2l6ZSAtIDgpO1xuXG4gICAgICB0aGlzLmRpc2tCbG9ja3MucHVzaChibG9jayk7XG4gICAgfVxuXG4gICAgLy8gaWYgKG5hbWUgPT0gJ0xPRkYnKSB7XG4gICAgLy8gICB0aGlzLm51bXJvb21zID0gc3RyZWFtLmdldFVpbnQ4KCk7XG4gICAgLy9cbiAgICAvLyAgIGxldCBvZmZzZXRzID0gW107XG4gICAgLy9cbiAgICAvLyAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5udW1yb29tczsgaSsrKSB7XG4gICAgLy8gICAgIGxldCByb29taWQgPSBzdHJlYW0uZ2V0VWludDgoKTtcbiAgICAvLyAgICAgbGV0IG9mZnMgPSBzdHJlYW0uZ2V0VWludDMyTEUoKTtcbiAgICAvLyAgICAgb2Zmc2V0c1tyb29taWRdID0gb2ZmcztcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgLy8gU2F2ZSBvdXQgUk9PTSBibG9ja3NcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvZmZzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgIGxldCBvZmZzID0gb2Zmc2V0c1tpXTtcbiAgICAvLyAgICAgaWYgKG9mZnMgIT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gICAgICAgc3RyZWFtLnNlZWsob2Zmcyk7XG4gICAgLy8gICAgICAgbGV0IG5hbWUgPSB0aGlzLnBhcnNlQmxvY2tOYW1lKHN0cmVhbSk7XG4gICAgLy8gICAgICAgbGV0IHNpemUgPSBzdHJlYW0uZ2V0VWludDMyKCk7XG4gICAgLy8gICAgICAgdGhpcy5yb29tc1tpXSA9IHN0cmVhbS5nZXRCeXRlcyhzaXplIC0gOCk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgLy8gU2F2ZSBvdXQgQ09TVCBibG9ja3NcbiAgICAvL1xuICAgIC8vICAgLy8gZm9yICh2YXIgaSA9IDA7IGkgPCBvZmZzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAvLyAgIHN0cmVhbS5zZWVrKG9mZnMgLSA4KTtcbiAgICAvLyAgIC8vICAgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAvLyAgIC8vICAgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAgIGxldCBlbmQgPSBzdHJlYW0ub2Zmc2V0ICsgc2l6ZSAtIDg7XG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gICB3aGlsZSAoc3RyZWFtLm9mZnNldCA8PSBlbmQpIHtcbiAgICAvLyAgIC8vICAgICBpZiAoc3RyZWFtLm9mZnNldCArIDggPiBzdHJlYW0ubGVuZ3RoKSBicmVhaztcbiAgICAvLyAgIC8vICAgICBsZXQgbmFtZSA9IHRoaXMucGFyc2VCbG9ja05hbWUoc3RyZWFtKTtcbiAgICAvLyAgIC8vICAgICBsZXQgc2l6ZSA9IHN0cmVhbS5nZXRVaW50MzIoKTtcbiAgICAvLyAgIC8vICAgICBpZiAobmFtZSA9PSAnQ09TVCcpIHtcbiAgICAvLyAgIC8vICAgICAgIGNvbnNvbGUubG9nKGksIG5hbWUpO1xuICAgIC8vICAgLy8gICAgIH1cbiAgICAvLyAgIC8vICAgICBzdHJlYW0uYWR2YW5jZShzaXplIC0gOCk7XG4gICAgLy8gICAvLyAgIH1cbiAgICAvLyAgIC8vIH1cbiAgICAvL1xuICAgIC8vIH1cbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gUmVzb3VyY2U7XG4iLCJjb25zdCBSb29tT2JqZWN0ID0gcmVxdWlyZSgnLi9yb29tX29iamVjdCcpO1xuXG5jbGFzcyBSb29tIHtcbiAgY29uc3RydWN0b3IocGFyYW1zKSB7XG4gICAgdGhpcy5pZCA9IHBhcmFtcy5pZDtcbiAgICB0aGlzLm5hbWUgPSBwYXJhbXMubmFtZTtcbiAgICB0aGlzLndpZHRoID0gcGFyYW1zLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgICB0aGlzLm51bU9iamVjdHMgPSBwYXJhbXMubnVtT2JqZWN0cztcbiAgICB0aGlzLm9iSU1zID0gcGFyYW1zLm9iSU1zO1xuICAgIHRoaXMub2JDRHMgPSBwYXJhbXMub2JDRHM7XG4gICAgdGhpcy5wYWxldHRlID0gcGFyYW1zLnBhbGV0dGU7XG4gICAgdGhpcy5iaXRtYXAgPSBwYXJhbXMuYml0bWFwO1xuICAgIHRoaXMuY29zdHVtZXMgPSBwYXJhbXMuY29zdHVtZXM7XG4gICAgdGhpcy50cmFuc3BhcmVudCA9IHBhcmFtcy50cmFuc3BhcmVudDtcbiAgfVxuXG4gIGdldE9iamVjdHMoKSB7XG4gICAgbGV0IG9iamVjdHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JJTXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBvYmltID0gdGhpcy5vYklNc1tpXTtcbiAgICAgIGlmIChvYmltKSB7XG4gICAgICAgIGxldCBvYmNkID0gdGhpcy5vYkNEc1tvYmltLmlkXTtcbiAgICAgICAgbGV0IG9iID0gbmV3IFJvb21PYmplY3Qoe1xuICAgICAgICAgIGlkOiBvYmltLmlkLFxuICAgICAgICAgIG5hbWU6IG9iY2QubmFtZSxcbiAgICAgICAgICB4OiBvYmltLngsXG4gICAgICAgICAgeTogb2JpbS55LFxuICAgICAgICAgIHdpZHRoOiBvYmltLndpZHRoLFxuICAgICAgICAgIGhlaWdodDogb2JpbS5oZWlnaHQsXG4gICAgICAgICAgYml0bWFwczogb2JpbS5iaXRtYXBzXG4gICAgICAgIH0pO1xuICAgICAgICBvYmplY3RzLnB1c2gob2IpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0cztcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJvb207XG4iLCJcbmNsYXNzIFJvb21PYmplY3Qge1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICB0aGlzLmlkID0gcGFyYW1zLmlkO1xuICAgIHRoaXMubmFtZSA9IHBhcmFtcy5uYW1lO1xuICAgIHRoaXMuaW1ubiA9IHBhcmFtcy5pbW5uO1xuICAgIHRoaXMuenBubiA9IHBhcmFtcy56cG5uO1xuICAgIHRoaXMuZmxhZ3MgPSBwYXJhbXMuZmxhZ3M7XG4gICAgdGhpcy54ID0gcGFyYW1zLng7XG4gICAgdGhpcy55ID0gcGFyYW1zLnk7XG4gICAgdGhpcy53aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IHBhcmFtcy5oZWlnaHQ7XG4gICAgdGhpcy5iaXRtYXBzID0gcGFyYW1zLmJpdG1hcHM7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBSb29tT2JqZWN0O1xuIiwiXG5jbGFzcyBDb250YWluZXIge1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmFtcy5wYXJlbnQ7XG5cbiAgICB0aGlzLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdjb250YWluZXInKTtcblxuICAgIHRoaXMudGl0bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMudGl0bGVFbC5pZCA9ICd0aXRsZSc7XG4gICAgdGhpcy50aXRsZUVsLmNsYXNzTGlzdC5hZGQoJ2NvbnRhaW5lci10aXRsZScpO1xuICAgIHRoaXMudGl0bGVFbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShwYXJhbXMudGl0bGUpKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMudGl0bGVFbCk7XG5cbiAgICB0aGlzLmNvbnRlbnRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuY29udGVudEVsLmlkID0gJ2NvbnRlbnQnO1xuICAgIHRoaXMuY29udGVudEVsLmNsYXNzTGlzdC5hZGQoJ2NvbnRhaW5lci1jb250ZW50Jyk7XG5cbiAgICB0aGlzLmNvbnRlbnRFbC5hcHBlbmRDaGlsZChwYXJhbXMuY29udGVudCk7XG5cbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuY29udGVudEVsKTtcblxuICAgIHRoaXMuZWwuc3R5bGUubGVmdCA9IHBhcmFtcy54ICsgJ3B4JztcbiAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IHBhcmFtcy55ICsgJ3B4JztcblxuICAgIC8vIHRoaXMuY29udGVudEVsLnN0eWxlLndpZHRoID0gcGFyYW1zLndpZHRoICsgJ3B4JztcbiAgICAvLyB0aGlzLmNvbnRlbnRFbC5zdHlsZS5oZWlnaHQgPSBwYXJhbXMuaGVpZ2h0ICsgJ3B4JztcbiAgICB0aGlzLnNldFNpemUocGFyYW1zLndpZHRoLCBwYXJhbXMuaGVpZ2h0KTtcblxuICAgIGlmIChwYXJhbXMuc3RhdHVzKSB7XG4gICAgICBsZXQgc3RhdHVzRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHN0YXR1c0VsLmNsYXNzTGlzdC5hZGQoJ2NvbnRhaW5lci1zdGF0dXMnKTtcbiAgICAgIC8vIHN0YXR1c0VsLmlubmVySFRNTCA9ICdTdGF0dXMgMTIzNDU2Nzg5MCc7XG4gICAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHN0YXR1c0VsKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMpO1xuXG4gICAgLy8gdGhpcy5lbC50YWJJbmRleCA9IC0xO1xuICB9XG5cbiAgZG9tKCkge1xuICAgIHJldHVybiB0aGlzLmVsO1xuICB9XG5cbiAgc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgdGhpcy5jb250ZW50RWwuc3R5bGUubWF4V2lkdGggPSB0aGlzLmNvbnRlbnRFbC5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgICB0aGlzLmNvbnRlbnRFbC5zdHlsZS5tYXhIZWlnaHQgPSB0aGlzLmNvbnRlbnRFbC5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuXG4gIH1cblxuICBjYW5jZWxEcmFnKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcyk7XG4gIH1cblxuICBvbk1vdXNlTW92ZShldmVudCkge1xuICAgIGxldCB4ID0gZXZlbnQubW92ZW1lbnRYO1xuICAgIGxldCB5ID0gZXZlbnQubW92ZW1lbnRZO1xuICAgIHRoaXMuZWwuc3R5bGUubGVmdCA9ICh0aGlzLmVsLm9mZnNldExlZnQgKyB4KSArICdweCc7XG4gICAgdGhpcy5lbC5zdHlsZS50b3AgPSAodGhpcy5lbC5vZmZzZXRUb3AgKyB5KSArICdweCc7XG4gIH1cblxuICBvbk1vdXNlRG93bihldmVudCkge1xuICAgIGlmIChldmVudC5idXR0b24gPT0gMCAmJiBldmVudC50YXJnZXQgPT09IHRoaXMudGl0bGVFbCkge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcyk7XG4gICAgfVxuICB9XG5cbiAgb25Nb3VzZVVwKGV2ZW50KSB7XG4gICAgdGhpcy5jYW5jZWxEcmFnKCk7XG4gIH1cblxuICBvbkJsdXIoZXZlbnQpIHtcbiAgICB0aGlzLmNhbmNlbERyYWcoKTtcbiAgfVxuXG4gIG9uQmx1cihldmVudCkge1xuICAgIHRoaXMuY2FuY2VsRHJhZygpO1xuICB9XG5cbiAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudHlwZSA9PSAnbW91c2Vkb3duJykge1xuICAgICAgdGhpcy5vbk1vdXNlRG93bihldmVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT0gJ21vdXNldXAnKSB7XG4gICAgICB0aGlzLm9uTW91c2VVcChldmVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT0gJ21vdXNlbW92ZScpIHtcbiAgICAgIHRoaXMub25Nb3VzZU1vdmUoZXZlbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudC50eXBlID09ICdmb2N1cycpIHtcbiAgICAgIHRoaXMub25Gb2N1cyhldmVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT0gJ2JsdXInKSB7XG4gICAgICB0aGlzLm9uQmx1cihldmVudCk7XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ29udGFpbmVyO1xuIiwiXG5jbGFzcyBMaXN0IHtcbiAgY29uc3RydWN0b3IocGFyYW1zPXt9KSB7XG4gICAgLy8gdGhpcy50eXBlID0gcGFyYW1zLnR5cGUgPT0gdW5kZWZpbmVkID8gJ2xpc3QnIDogcGFyYW1zLnR5cGU7XG4gICAgdGhpcy50eXBlID0gcGFyYW1zLnR5cGUgfHwgJ2Jhc2ljLWxpc3QnO1xuICAgIHRoaXMubXVsdGlwbGUgPSBwYXJhbXMubXVsdGlwbGU7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMuc2VsZWN0aW9uID0gW107XG5cbiAgICB0aGlzLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdsaXN0Jyk7XG4gICAgdGhpcy5saXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLmxpc3RFbC5jbGFzc0xpc3QuYWRkKHRoaXMudHlwZSk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmxpc3RFbCk7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzKTtcblxuICAgIHRoaXMuZWwudGFiSW5kZXggPSAtMTtcbiAgfVxuXG4gIGNyZWF0ZUl0ZW0oaXRlbSkge1xuICAgIGxldCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsLmlkID0gJ2l0ZW0nICsgaXRlbS5pZDtcbiAgICBlbC5kYXRhc2V0LmlkID0gaXRlbS5pZDtcblxuICAgIGlmICh0aGlzLnR5cGUgPT0gJ2ljb24tbGlzdCcpIHtcbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2ljb24tbGlzdC1pdGVtJyk7XG5cbiAgICAgIGxldCBpbWFnZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBpbWFnZUVsLmNsYXNzTGlzdC5hZGQoJ2ljb24tbGlzdC1pbWFnZScpO1xuICAgICAgaW1hZ2VFbC5hcHBlbmRDaGlsZChpdGVtLmltYWdlKTtcbiAgICAgIGVsLmFwcGVuZENoaWxkKGltYWdlRWwpO1xuXG4gICAgICBsZXQgdGl0bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGl0bGVFbC5jbGFzc0xpc3QuYWRkKCdpY29uLWxpc3QtdGl0bGUnKTtcbiAgICAgIHRpdGxlRWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoaXRlbS50aXRsZSkpO1xuICAgICAgZWwuYXBwZW5kQ2hpbGQodGl0bGVFbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2Jhc2ljLWxpc3QtaXRlbScpO1xuICAgICAgZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoaXRlbS50aXRsZSkpO1xuICAgIH1cblxuICAgIHRoaXMubGlzdEVsLmFwcGVuZENoaWxkKGVsKTtcblxuICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgfVxuXG4gIGFkZEl0ZW0oY2FuZGlkYXRlKSB7XG4gICAgaWYgKGNhbmRpZGF0ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbmRpZGF0ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgaXRlbSA9IGNhbmRpZGF0ZVtpXTtcbiAgICAgICAgdGhpcy5jcmVhdGVJdGVtKGl0ZW0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNyZWF0ZUl0ZW0oY2FuZGlkYXRlKTtcbiAgICB9XG4gIH1cblxuICBnZXRJdGVtQnlJZChpZCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1zLmZpbmQoZWxlbWVudCA9PiBlbGVtZW50LmlkID09IGlkKTtcbiAgfVxuXG4gIGRvbSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbDtcbiAgfVxuXG4gIHNlbGVjdChpbmRleCwgdG9nZ2xlPWZhbHNlKSB7XG4gICAgbGV0IGl0ZW0gPSB0aGlzLml0ZW1zW2luZGV4XTtcblxuICAgIGlmICghdGhpcy5zZWxlY3Rpb24uaW5jbHVkZXMoaXRlbSkpIHtcbiAgICAgIGxldCBlbCA9IHRoaXMubGlzdEVsLnF1ZXJ5U2VsZWN0b3IoJyNpdGVtJyArIGl0ZW0uaWQpO1xuICAgICAgaWYgKGVsKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICB9XG4gICAgICB0aGlzLnNlbGVjdGlvbi5wdXNoKGl0ZW0pO1xuICAgICAgLy8gY29uc29sZS5sb2coZWwub2Zmc2V0TGVmdCwgZWwub2Zmc2V0VG9wKTtcbiAgICAgIGxldCBsZWZ0ID0gZWwub2Zmc2V0TGVmdDtcbiAgICAgIGxldCB0b3AgPSBlbC5vZmZzZXRUb3A7XG4gICAgICBsZXQgd2lkdGggPSBlbC5vZmZzZXRXaWR0aDtcbiAgICAgIGxldCBoZWlnaHQgPSBlbC5vZmZzZXRIZWlnaHQ7XG4gICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmVsLm9mZnNldEhlaWdodCk7XG4gICAgICBpZiAodG9wICsgaGVpZ2h0ID4gdGhpcy5lbC5zY3JvbGxUb3AgKyB0aGlzLmVsLm9mZnNldEhlaWdodCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnb3V0c2lkZScsIHRvcCsgaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5lbC5zY3JvbGxUb3AgPSBlbC5vZmZzZXRUb3AgLSB0aGlzLmVsLm9mZnNldEhlaWdodCArIGhlaWdodDtcbiAgICAgIH0gZWxzZSBpZiAodG9wIDwgdGhpcy5lbC5zY3JvbGxUb3ApIHtcbiAgICAgICAgdGhpcy5lbC5zY3JvbGxUb3AgPSB0b3A7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0b2dnbGUpIHtcbiAgICAgICAgdGhpcy5kZXNlbGVjdChpbmRleCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gbGV0IHJlY3QgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIC8vIGNvbnNvbGUubG9nKHJlY3QpO1xuXG4gICAgdGhpcy5hbm5vdW5jZUNoYW5nZSgpO1xuICB9XG5cbiAgZGVzZWxlY3QoaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IGl0ZW0gPSB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgIGxldCBlbCA9IHRoaXMubGlzdEVsLnF1ZXJ5U2VsZWN0b3IoJyNpdGVtJyArIGl0ZW0uaWQpO1xuICAgICAgICBpZiAoZWwpIHtcbiAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uID0gdGhpcy5zZWxlY3Rpb24uZmlsdGVyKGVsZW1lbnQgPT4gZWxlbWVudCAhPT0gaXRlbSk7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgaXRlbSA9IHRoaXMuc2VsZWN0aW9uW2ldO1xuICAgICAgICBsZXQgZWwgPSB0aGlzLmxpc3RFbC5xdWVyeVNlbGVjdG9yKCcjaXRlbScgKyBpdGVtLmlkKTtcbiAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zZWxlY3Rpb24gPSBbXTtcbiAgICB9XG4gICAgdGhpcy5hbm5vdW5jZUNoYW5nZSgpO1xuICB9XG5cbiAgc2VsZWN0TmV4dCgpIHtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIGlmICh0aGlzLnNlbGVjdGlvbi5sZW5ndGgpIHtcbiAgICAgIGxldCBpdGVtID0gdGhpcy5zZWxlY3Rpb25bdGhpcy5zZWxlY3Rpb24ubGVuZ3RoIC0gMV07XG4gICAgICBpbmRleCA9IHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKSArIDE7XG4gICAgICBpZiAoaW5kZXggPiB0aGlzLml0ZW1zLmxlbmd0aCAtIDEpIGluZGV4ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgICAgdGhpcy5kZXNlbGVjdCgpO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdChpbmRleCk7XG4gICAgLy8gdGhpcy5hbm5vdW5jZUNoYW5nZSgpO1xuICB9XG5cbiAgc2VsZWN0UHJldmlvdXMoKSB7XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICBpZiAodGhpcy5zZWxlY3Rpb24ubGVuZ3RoKSB7XG4gICAgICBsZXQgaXRlbSA9IHRoaXMuc2VsZWN0aW9uWzBdO1xuICAgICAgaW5kZXggPSB0aGlzLml0ZW1zLmluZGV4T2YoaXRlbSkgLSAxO1xuICAgICAgaWYgKGluZGV4IDwgMCkgaW5kZXggPSAwO1xuICAgICAgdGhpcy5kZXNlbGVjdCgpO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdChpbmRleCk7XG4gICAgLy8gdGhpcy5hbm5vdW5jZUNoYW5nZSgpO1xuICB9XG5cbiAgYW5ub3VuY2VDaGFuZ2UoKSB7XG4gICAgdmFyIG15RXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NoYW5nZScsIHtcbiAgICAgIGRldGFpbDogeyBzZWxlY3Rpb246IHRoaXMuc2VsZWN0aW9uIH1cbiAgICB9KTtcbiAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQobXlFdmVudCk7XG4gIH1cblxuICBvbk1vdXNlRG93bihldmVudCkge1xuICAgIGlmIChldmVudC5idXR0b24gPT0gMCkge1xuICAgICAgLy8gY29uc29sZS5sb2coZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUpO1xuICAgICAgLy8gY29uc29sZS5sb2coJ2V2ZW50LmJ1dHRvbicsIGV2ZW50LmJ1dHRvbik7XG4gICAgICBsZXQgaWQgPSBldmVudC50YXJnZXQuZGF0YXNldC5pZDtcbiAgICAgIGlmIChpZCkge1xuICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZ2V0SXRlbUJ5SWQoaWQpO1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLml0ZW1zLmluZGV4T2YoaXRlbSk7XG5cbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGUpIHtcbiAgICAgICAgICBsZXQgdG9nZ2xlID0gZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5O1xuICAgICAgICAgIGlmICghdG9nZ2xlKSB0aGlzLmRlc2VsZWN0KCk7XG4gICAgICAgICAgdGhpcy5zZWxlY3QoaW5kZXgsIHRvZ2dsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5kZXNlbGVjdCgpO1xuICAgICAgICAgIHRoaXMuc2VsZWN0KGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMuZGVzZWxlY3QoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbktleURvd24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09ICdBcnJvd0xlZnQnKSB7XG4gICAgICBpZiAodGhpcy50eXBlID09ICdpY29uLWxpc3QnKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0UHJldmlvdXMoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQua2V5ID09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgaWYgKHRoaXMudHlwZSA9PSAnaWNvbi1saXN0Jykge1xuICAgICAgICB0aGlzLnNlbGVjdE5leHQoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQua2V5ID09ICdBcnJvd0Rvd24nKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKHRoaXMudHlwZSA9PSAnYmFzaWMtbGlzdCcpIHtcbiAgICAgICAgdGhpcy5zZWxlY3ROZXh0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PSAnQXJyb3dVcCcpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAodGhpcy50eXBlID09ICdiYXNpYy1saXN0Jykge1xuICAgICAgICB0aGlzLnNlbGVjdFByZXZpb3VzKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25Gb2N1cyhldmVudCkge1xuICAgIC8vIHRoaXMuZWwuc3R5bGUuYm9yZGVyID0gJzJweCBzb2xpZCByZWQnO1xuICB9XG5cbiAgb25CbHVyKGV2ZW50KSB7XG4gICAgLy8gdGhpcy5lbC5zdHlsZS5ib3JkZXIgPSAnaW5pdGlhbCc7XG4gIH1cblxuICBoYW5kbGVFdmVudChldmVudCkge1xuICAgIGlmIChldmVudC50eXBlID09ICdtb3VzZWRvd24nKSB7XG4gICAgICB0aGlzLm9uTW91c2VEb3duKGV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PSAna2V5ZG93bicpIHtcbiAgICAgIHRoaXMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PSAnZm9jdXMnKSB7XG4gICAgICB0aGlzLm9uRm9jdXMoZXZlbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudC50eXBlID09ICdibHVyJykge1xuICAgICAgdGhpcy5vbkJsdXIoZXZlbnQpO1xuICAgIH1cbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gTGlzdDtcbiIsIlxuY2xhc3MgV29ya3NwYWNlIHtcbiAgY29uc3RydWN0b3IocGFyYW1zKSB7XG4gICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnd29ya3NwYWNlJyk7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJhbXMucGFyZW50O1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcbiAgfVxuXG4gIGFkZChjaGlsZCkge1xuICAgIGNoaWxkLnogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aCA/IHRoaXMuY2hpbGRyZW5bdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxXS56ICsgMSA6IDE7XG4gICAgbGV0IGNoaWxkRWwgPSBjaGlsZC5kb20oKTtcbiAgICBjaGlsZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMpO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQoY2hpbGRFbCk7XG4gICAgY2hpbGRFbC5zdHlsZS56SW5kZXggPSBjaGlsZC56O1xuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gIH1cblxuICByZW1vdmUoY2hpbGQpIHtcbiAgICBsZXQgY2hpbGRFbCA9IGNoaWxkLmRvbSgpO1xuICAgIGNoaWxkRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcyk7XG4gICAgdGhpcy5lbC5yZW1vdmVDaGlsZChjaGlsZEVsKTtcbiAgICB0aGlzLmNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbi5maWx0ZXIoZWxlbWVudCA9PiBlbGVtZW50ICE9PSBjaGlsZCk7XG4gIH1cblxuICBicmluZ1RvRnJvbnQoY2hpbGQpIHtcbiAgICBjaGlsZC56ID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xuICAgIHRoaXMuY2hpbGRyZW4uc29ydCgoYSwgYikgPT4geyByZXR1cm4gYS56IC0gYi56IH0gKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjaGlsZCA9IHRoaXMuY2hpbGRyZW5baV07XG4gICAgICBjaGlsZC5kb20oKS5zdHlsZS56SW5kZXggPSBjaGlsZC56ID0gaTtcbiAgICB9XG4gIH1cblxuICBvbk1vdXNlRG93bihldmVudCkge1xuICAgIGxldCB0ZW1wID0gZXZlbnQudGFyZ2V0O1xuXG4gICAgd2hpbGUgKHRlbXAucGFyZW50Tm9kZSAmJiB0ZW1wLnBhcmVudE5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgIGlmICh0ZW1wLnBhcmVudE5vZGUgPT09IHRoaXMuZWwpIGJyZWFrO1xuICAgICAgdGVtcCA9IHRlbXAucGFyZW50Tm9kZTtcbiAgICB9XG5cbiAgICBsZXQgY2hpbGQgPSB0aGlzLmNoaWxkcmVuLmZpbmQoZWxlbWVudCA9PiBlbGVtZW50LmRvbSgpID09PSB0ZW1wKTtcbiAgICBpZiAoY2hpbGQpIHtcbiAgICAgIHRoaXMuYnJpbmdUb0Zyb250KGNoaWxkKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVFdmVudChldmVudCkge1xuICAgIGlmIChldmVudC50eXBlID09ICdtb3VzZWRvd24nKSB7XG4gICAgICB0aGlzLm9uTW91c2VEb3duKGV2ZW50KTtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBXb3Jrc3BhY2U7XG4iXX0="}